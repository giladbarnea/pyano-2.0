"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const electron_1 = require("electron");
function round(n, d = 0) {
    const fr = 10 ** d;
    return int(n * fr) / fr;
}
function float(str) {
    return parseFloat(str);
}
function int(x, base) {
    return parseInt(x, base);
}
exports.int = int;
function str(val) {
    return val ? val.toString() : "";
}
exports.str = str;
function bool(val) {
    if (val === null)
        return false;
    const typeofval = typeof val;
    if (typeofval !== 'object') {
        if (typeofval === 'function')
            return true;
        else
            return !!val;
    }
    return Object.keys(val).length !== 0;
}
exports.bool = bool;
function enumerate(obj) {
    let typeofObj = typeof obj;
    if (obj === undefined
        || isEmptyObj(obj)
        || isEmptyArr(obj)
        || obj === "") {
        return [];
    }
    if (obj === null
        || typeofObj === "boolean"
        || typeofObj === "number"
        || typeofObj === "function") {
        throw new TypeError(`${typeofObj} object is not iterable`);
    }
    let array = [];
    if (isArray(obj)) {
        let i = 0;
        for (let x of obj) {
            array.push([i, x]);
            i++;
        }
    }
    else {
        for (let prop in obj) {
            array.push([prop, obj[prop]]);
        }
    }
    return array;
}
exports.enumerate = enumerate;
function wait(ms) {
    if (skipFade)
        return;
    return new Promise(resolve => setTimeout(resolve, ms));
}
exports.wait = wait;
async function waitUntil(cond, timeout = Infinity, checkInterval = 20) {
    if (checkInterval <= 0)
        throw new Error(`checkInterval <= 0. checkInterval: ${checkInterval}`);
    if (checkInterval > timeout)
        throw new Error(`checkInterval > timeout (${checkInterval} > ${timeout}). Has to be lower than timeout.`);
    const loops = timeout / checkInterval;
    if (loops == 1)
        console.warn(`loops == 1, you probably didn't want this to happen`);
    let count = 0;
    while (count < loops) {
        if (cond())
            return true;
        await wait(checkInterval);
        count++;
    }
    return false;
}
let stuff = {
    '()=>{}': () => {
    }, 'function(){}': function () {
    }, 'Function': Function,
    'Function()': Function(),
    "new Function()": new Function(),
    "Boolean": Boolean,
    "Boolean()": Boolean(),
    "new Boolean()": new Boolean(),
    "new Boolean(true)": new Boolean(true),
    "new Boolean(false)": new Boolean(false),
    "true": true,
    "false": false,
    "Number": Number,
    "Number()": Number(),
    "new Number()": new Number(),
    "new Number(0)": new Number(0),
    "new Number(1)": new Number(1),
    "0": 0,
    "1": 1,
    "''": '',
    "' '": ' ',
    "'foo'": 'foo',
    "'0'": '0',
    "'1'": '1',
    "{}": {},
    "{ hi : 'bye' }": { hi: 'bye' },
    "[]": [],
    "[ 1 ]": [1],
    "undefined": undefined,
    "null": null,
};
function notnot(obj) {
    return !!obj;
}
function isArray(obj) {
    if (!obj)
        return false;
    return typeof obj !== 'string' && (Array.isArray(obj) || typeof obj[Symbol.iterator] === 'function');
}
function isEmpty(obj) {
    let toStringed = {}.toString.call(obj);
    return (toStringed === '[object Object]' || toStringed === '[object Array]') && Object.keys(obj).length == 0;
}
function isEmptyArr(collection) {
    return isArray(collection) && getLength(collection) === 0;
}
function isEmptyObj(obj) {
    return isObject(obj) && !isArray(obj) && Object.keys(obj).length === 0;
}
function isFunction(fn) {
    let toStringed = {}.toString.call(fn);
    return !!fn && toStringed === '[object Function]';
}
exports.isFunction = isFunction;
function isTMap(obj) {
    return {}.toString.call(obj) == '[object Object]';
}
function isObject(obj) {
    return typeof obj === 'object' && !!obj;
}
exports.isObject = isObject;
function shallowProperty(key) {
    return function (obj) {
        return obj == null ? void 0 : obj[key];
    };
}
function getLength(collection) {
    return shallowProperty('length')(collection);
}
function any(collection) {
    return collection.some(item => bool(item));
}
exports.any = any;
function all(arr) {
    return arr.every(item => bool(item));
}
exports.all = all;
function sum(arr) {
    let sum = 0;
    let dirty = false;
    for (let v of arr) {
        let number = float(v);
        if (!isNaN(number)) {
            dirty = true;
            sum += number;
        }
    }
    return !dirty ? undefined : sum;
}
exports.sum = sum;
function getCurrentWindow() {
    return electron_1.remote.getCurrentWindow();
}
function reloadPage() {
    getCurrentWindow().reload();
}
exports.reloadPage = reloadPage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx1Q0FBa0M7QUFFbEMsU0FBUyxLQUFLLENBQUMsQ0FBUyxFQUFFLElBQVksQ0FBQztJQUNuQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25CLE9BQU8sR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDNUIsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEdBQVc7SUFDdEIsT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDM0IsQ0FBQztBQUVELFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFpQztJQUM3QyxPQUFPLFFBQVEsQ0FBQyxDQUFDLEVBQVcsSUFBSSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQTJkb0Msa0JBQUc7QUF6ZHhDLFNBQVMsR0FBRyxDQUFDLEdBQVE7SUFDakIsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ3BDLENBQUM7QUF1ZHFGLGtCQUFHO0FBcmR6RixTQUFTLElBQUksQ0FBQyxHQUFRO0lBNEJsQixJQUFLLEdBQUcsS0FBSyxJQUFJO1FBQ2IsT0FBTyxLQUFLLENBQUM7SUFDakIsTUFBTSxTQUFTLEdBQUcsT0FBTyxHQUFHLENBQUM7SUFDN0IsSUFBSyxTQUFTLEtBQUssUUFBUSxFQUFHO1FBQzFCLElBQUssU0FBUyxLQUFLLFVBQVU7WUFDekIsT0FBTyxJQUFJLENBQUM7O1lBRVosT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDO0tBQ3BCO0lBQ0QsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUM7QUFDekMsQ0FBQztBQStha0Isb0JBQUk7QUE3YXZCLFNBQVMsU0FBUyxDQUFJLEdBQU07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QyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQTtBQUNoRCxDQUFDO0FBR0QsU0FBUyxHQUFHLENBQUMsVUFBaUI7SUFDMUIsT0FBTyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDL0MsQ0FBQztBQThCUSxrQkFBRztBQTNCWixTQUFTLEdBQUcsQ0FBQyxHQUFVO0lBQ25CLE9BQU8sR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUF5QmEsa0JBQUc7QUF0QmpCLFNBQVMsR0FBRyxDQUFDLEdBQVU7SUFDbkIsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBQ1osSUFBSSxLQUFLLEdBQUcsS0FBSyxDQUFDO0lBQ2xCLEtBQU0sSUFBSSxDQUFDLElBQUksR0FBRyxFQUFHO1FBQ2pCLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0QixJQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFHO1lBQ2xCLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDYixHQUFHLElBQUksTUFBTSxDQUFDO1NBQ2pCO0tBRUo7SUFDRCxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztBQUNwQyxDQUFDO0FBVWdGLGtCQUFHO0FBUnBGLFNBQVMsZ0JBQWdCO0lBQ3JCLE9BQU8saUJBQU0sQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0FBQ3JDLENBQUM7QUFFRCxTQUFTLFVBQVU7SUFDZixnQkFBZ0IsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDO0FBQ2hDLENBQUM7QUFFd0IsZ0NBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW1vdGUgfSBmcm9tICdlbGVjdHJvbic7XG5cbmZ1bmN0aW9uIHJvdW5kKG46IG51bWJlciwgZDogbnVtYmVyID0gMCkge1xuICAgIGNvbnN0IGZyID0gMTAgKiogZDtcbiAgICByZXR1cm4gaW50KG4gKiBmcikgLyBmcjtcbn1cblxuZnVuY3Rpb24gZmxvYXQoc3RyOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIHJldHVybiBwYXJzZUZsb2F0KHN0cik7XG59XG5cbmZ1bmN0aW9uIGludCh4LCBiYXNlPzogc3RyaW5nIHwgbnVtYmVyIHwgRnVuY3Rpb24pOiBudW1iZXIge1xuICAgIHJldHVybiBwYXJzZUludCh4LCA8bnVtYmVyPiBiYXNlKTtcbn1cblxuZnVuY3Rpb24gc3RyKHZhbDogYW55KSB7XG4gICAgcmV0dXJuIHZhbCA/IHZhbC50b1N0cmluZygpIDogXCJcIlxufVxuXG5mdW5jdGlvbiBib29sKHZhbDogYW55KTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyAxICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICcwJyAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gJzEnICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAoKT0+e30gICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIEJvb2xlYW4gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gRnVuY3Rpb24gICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBGdW5jdGlvbigpICAgICAgICAgIHRydWVcbiAgICAvLyAvIE51bWJlciAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gWyAxIF0gICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gZnVuY3Rpb24oKXt9ICAgICAgICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgICBmYWxzZSAgICAgIGRpZmYgZnJvbSBuYXRpdmVcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgLy8gLyBuZXcgRnVuY3Rpb24oKSAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgICBmYWxzZSAgICAgIGRpZmYgZnJvbSBuYXRpdmVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHRydWUgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8geyBoaSA6ICdieWUnIH0gICAgICB0cnVlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIGlmICggdmFsID09PSBudWxsIClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHR5cGVvZnZhbCA9IHR5cGVvZiB2YWw7XG4gICAgaWYgKCB0eXBlb2Z2YWwgIT09ICdvYmplY3QnICkge1xuICAgICAgICBpZiAoIHR5cGVvZnZhbCA9PT0gJ2Z1bmN0aW9uJyApXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuICEhdmFsO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LmtleXModmFsKS5sZW5ndGggIT09IDA7XG59XG5cbmZ1bmN0aW9uIGVudW1lcmF0ZTxUPihvYmo6IFQpOiBFbnVtZXJhdGVkPFQ+IHtcbiAgICAvLyB1bmRlZmluZWQgICAgW11cbiAgICAvLyB7fSAgICAgICAgICAgW11cbiAgICAvLyBbXSAgICAgICAgICAgW11cbiAgICAvLyBcIlwiICAgICAgICAgICBbXVxuICAgIC8vIG51bWJlciAgICAgICBUeXBlRXJyb3JcbiAgICAvLyBudWxsICAgICAgICAgVHlwZUVycm9yXG4gICAgLy8gYm9vbGVhbiAgICAgIFR5cGVFcnJvclxuICAgIC8vIEZ1bmN0aW9uICAgICBUeXBlRXJyb3JcbiAgICAvLyBcImZvb1wiICAgICAgICBbIFswLCBcImZcIl0sIFsxLCBcIm9cIl0sIFsyLCBcIm9cIl0gXVxuICAgIC8vIFsgXCJmb29cIiBdICAgIFsgWzAsIFwiZm9vXCJdIF1cbiAgICAvLyBbIDEwIF0gICAgICAgWyBbMCwgMTBdIF1cbiAgICAvLyB7IGE6IFwiZm9vXCIgfSBbIFtcImFcIiwgXCJmb29cIl0gXVxuICAgIC8vIC8vICgpPT57fSAgICA/XG4gICAgbGV0IHR5cGVvZk9iaiA9IHR5cGVvZiBvYmo7XG4gICAgaWYgKFxuICAgICAgICBvYmogPT09IHVuZGVmaW5lZFxuICAgICAgICB8fCBpc0VtcHR5T2JqKG9iailcbiAgICAgICAgfHwgaXNFbXB0eUFycihvYmopXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgfHwgb2JqID09PSBcIlwiXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBbXSBhcyBFbnVtZXJhdGVkPFQ+O1xuICAgIH1cbiAgICBcbiAgICBpZiAoXG4gICAgICAgIG9iaiA9PT0gbnVsbFxuICAgICAgICB8fCB0eXBlb2ZPYmogPT09IFwiYm9vbGVhblwiXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJudW1iZXJcIlxuICAgICAgICB8fCB0eXBlb2ZPYmogPT09IFwiZnVuY3Rpb25cIlxuICAgICkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke3R5cGVvZk9ian0gb2JqZWN0IGlzIG5vdCBpdGVyYWJsZWApO1xuICAgIH1cbiAgICBsZXQgYXJyYXkgPSBbXTtcbiAgICBpZiAoIGlzQXJyYXkob2JqKSApIHtcbiAgICAgICAgbGV0IGk6IG51bWJlciA9IDA7XG4gICAgICAgIGZvciAoIGxldCB4IG9mIG9iaiApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2goWyBpLCB4IF0pO1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICggbGV0IHByb3AgaW4gb2JqICkge1xuICAgICAgICAgICAgYXJyYXkucHVzaChbIHByb3AsIG9ialtwcm9wXSBdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXkgYXMgRW51bWVyYXRlZDxUPjtcbn1cblxuZnVuY3Rpb24gd2FpdChtczogbnVtYmVyKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoIHNraXBGYWRlIClcbiAgICAgICAgcmV0dXJuO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbn1cblxuLyoqQ2hlY2sgZXZlcnkgYGNoZWNrSW50ZXJ2YWxgIG1zIGlmIGBjb25kKClgIGlzIHRydXRoeS4gSWYsIHdpdGhpbiBgdGltZW91dGAsIGNvbmQoKSBpcyB0cnV0aHksIHJldHVybiBgdHJ1ZWAuIFJldHVybiBgZmFsc2VgIGlmIHRpbWUgaXMgb3V0LlxuICogQGV4YW1wbGVcbiAqIC8vIEdpdmUgdGhlIHVzZXIgYSAyMDBtcyBjaGFuY2UgdG8gZ2V0IGhlciBwb2ludGVyIG92ZXIgXCJteWRpdlwiLiBDb250aW51ZSBpbW1lZGlhdGVseSBvbmNlIHNoZSBkb2VzLCBvciBhZnRlciAyMDBtcyBpZiBzaGUgZG9lc24ndC5cbiAqIG15ZGl2LnBvaW50ZXJlbnRlciggKCkgPT4gbXlkaXYucG9pbnRlckhvdmVyaW5nID0gdHJ1ZTsgKVxuICogY29uc3QgcG9pbnRlck9uTXlkaXYgPSBhd2FpdCB3YWl0VW50aWwoKCkgPT4gbXlkaXYucG9pbnRlckhvdmVyaW5nLCAyMDAsIDEwKTsqL1xuYXN5bmMgZnVuY3Rpb24gd2FpdFVudGlsKGNvbmQ6ICgpID0+IGJvb2xlYW4sIHRpbWVvdXQ6IG51bWJlciA9IEluZmluaXR5LCBjaGVja0ludGVydmFsOiBudW1iZXIgPSAyMCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICggY2hlY2tJbnRlcnZhbCA8PSAwIClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsIDw9IDAuIGNoZWNrSW50ZXJ2YWw6ICR7Y2hlY2tJbnRlcnZhbH1gKTtcbiAgICBpZiAoIGNoZWNrSW50ZXJ2YWwgPiB0aW1lb3V0IClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsID4gdGltZW91dCAoJHtjaGVja0ludGVydmFsfSA+ICR7dGltZW91dH0pLiBIYXMgdG8gYmUgbG93ZXIgdGhhbiB0aW1lb3V0LmApO1xuICAgIFxuICAgIGNvbnN0IGxvb3BzID0gdGltZW91dCAvIGNoZWNrSW50ZXJ2YWw7XG4gICAgaWYgKCBsb29wcyA9PSAxIClcbiAgICAgICAgY29uc29sZS53YXJuKGBsb29wcyA9PSAxLCB5b3UgcHJvYmFibHkgZGlkbid0IHdhbnQgdGhpcyB0byBoYXBwZW5gKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHdoaWxlICggY291bnQgPCBsb29wcyApIHtcbiAgICAgICAgaWYgKCBjb25kKCkgKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGF3YWl0IHdhaXQoY2hlY2tJbnRlcnZhbCk7XG4gICAgICAgIGNvdW50Kys7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxubGV0IHN0dWZmID0ge1xuICAgICcoKT0+e30nIDogKCkgPT4ge1xuICAgIH0sICdmdW5jdGlvbigpe30nIDogZnVuY3Rpb24gKCkge1xuICAgIH0sICdGdW5jdGlvbicgOiBGdW5jdGlvbixcbiAgICAnRnVuY3Rpb24oKScgOiBGdW5jdGlvbigpLFxuICAgIFwibmV3IEZ1bmN0aW9uKClcIiA6IG5ldyBGdW5jdGlvbigpLFxuICAgIFwiQm9vbGVhblwiIDogQm9vbGVhbixcbiAgICBcIkJvb2xlYW4oKVwiIDogQm9vbGVhbigpLFxuICAgIFwibmV3IEJvb2xlYW4oKVwiIDogbmV3IEJvb2xlYW4oKSxcbiAgICBcIm5ldyBCb29sZWFuKHRydWUpXCIgOiBuZXcgQm9vbGVhbih0cnVlKSxcbiAgICBcIm5ldyBCb29sZWFuKGZhbHNlKVwiIDogbmV3IEJvb2xlYW4oZmFsc2UpLFxuICAgIFwidHJ1ZVwiIDogdHJ1ZSxcbiAgICBcImZhbHNlXCIgOiBmYWxzZSxcbiAgICBcIk51bWJlclwiIDogTnVtYmVyLFxuICAgIFwiTnVtYmVyKClcIiA6IE51bWJlcigpLFxuICAgIFwibmV3IE51bWJlcigpXCIgOiBuZXcgTnVtYmVyKCksXG4gICAgXCJuZXcgTnVtYmVyKDApXCIgOiBuZXcgTnVtYmVyKDApLFxuICAgIFwibmV3IE51bWJlcigxKVwiIDogbmV3IE51bWJlcigxKSxcbiAgICBcIjBcIiA6IDAsXG4gICAgXCIxXCIgOiAxLFxuICAgIFwiJydcIiA6ICcnLFxuICAgIFwiJyAnXCIgOiAnICcsXG4gICAgXCInZm9vJ1wiIDogJ2ZvbycsXG4gICAgXCInMCdcIiA6ICcwJyxcbiAgICBcIicxJ1wiIDogJzEnLFxuICAgIFwie31cIiA6IHt9LFxuICAgIFwieyBoaSA6ICdieWUnIH1cIiA6IHsgaGkgOiAnYnllJyB9LFxuICAgIFwiW11cIiA6IFtdLFxuICAgIFwiWyAxIF1cIiA6IFsgMSBdLFxuICAgIFwidW5kZWZpbmVkXCIgOiB1bmRlZmluZWQsXG4gICAgXCJudWxsXCIgOiBudWxsLFxufTtcblxuZnVuY3Rpb24gbm90bm90KG9iaikge1xuICAgIC8vIC8gMCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgdHJ1ZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgdHJ1ZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSB0cnVlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICBmYWxzZSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gIE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgdHJ1ZVxuICAgIC8vIC8gJycgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgIHRydWVcbiAgICAvLyBbXSAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgdW5kZWZpbmVkICAgICAgIGZhbHNlXG4gICAgLy8gLyAgbnVsbCAgICAgICAgICAgIGZhbHNlXG4gICAgcmV0dXJuICEhb2JqO1xufVxuXG5mdW5jdGlvbiBpc0FycmF5PFQ+KG9iaik6IG9iaiBpcyBBcnJheTxUPiB7IC8vIHNhbWUgYXMgQXJyYXkuaXNBcnJheVxuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnZm9vJyAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbIDEgXSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBpZiAoICFvYmogKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogIT09ICdzdHJpbmcnICYmIChBcnJheS5pc0FycmF5KG9iaikgfHwgdHlwZW9mIG9ialtTeW1ib2wuaXRlcmF0b3JdID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eShvYmo6IGFueSk6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIC8ge30gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIGxldCB0b1N0cmluZ2VkID0ge30udG9TdHJpbmcuY2FsbChvYmopO1xuICAgIHJldHVybiAodG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfHwgdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgQXJyYXldJykgJiYgT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT0gMDtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eUFycihjb2xsZWN0aW9uKTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHJldHVybiBpc0FycmF5KGNvbGxlY3Rpb24pICYmIGdldExlbmd0aChjb2xsZWN0aW9uKSA9PT0gMFxufVxuXG5mdW5jdGlvbiBpc0VtcHR5T2JqKG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgQm9vbGVhbigpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbihmYWxzZSl0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbih0cnVlKSB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IE51bWJlcigwKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigxKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigpICAgICAgdHJ1ZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gaXNPYmplY3Qob2JqKSAmJiAhaXNBcnJheShvYmopICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwXG59XG5cblxuZnVuY3Rpb24gaXNGdW5jdGlvbjxUPihmbjogRnVuY3Rpb25SZXR1cm5zPFQ+KTogZm4gaXMgRnVuY3Rpb25SZXR1cm5zPFQ+XG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuOiBBbnlGdW5jdGlvbik6IGZuIGlzIEFueUZ1bmN0aW9uXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuKSB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyAoKT0+e30gICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIEJvb2xlYW4gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIEZ1bmN0aW9uICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gRnVuY3Rpb24oKSAgICAgICAgICB0cnVlXG4gICAgLy8gLyBOdW1iZXIgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBmdW5jdGlvbigpe30gICAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyAvIG5ldyBGdW5jdGlvbigpICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgbGV0IHRvU3RyaW5nZWQgPSB7fS50b1N0cmluZy5jYWxsKGZuKTtcbiAgICByZXR1cm4gISFmbiAmJiB0b1N0cmluZ2VkID09PSAnW29iamVjdCBGdW5jdGlvbl0nXG59XG5cbmZ1bmN0aW9uIGlzVE1hcDxUPihvYmo6IFRNYXA8VD4pOiBvYmogaXMgVE1hcDxUPiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4ge30udG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IE9iamVjdF0nXG59XG5cbi8vICogIHVuZGVyc2NvcmUuanNcbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFsgMSBdICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oZmFsc2UpdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4odHJ1ZSkgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBOdW1iZXIoMCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoMSkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoKSAgICAgIHRydWVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgISFvYmo7XG59XG5cblxuZnVuY3Rpb24gc2hhbGxvd1Byb3BlcnR5PFQ+KGtleTogc3RyaW5nKTogKG9iajogVCkgPT4gVCBleHRlbmRzIG51bGwgPyB1bmRlZmluZWQgOiBUW2tleW9mIFRdIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAvLyA9PSBudWxsIHRydWUgZm9yIHVuZGVmaW5lZFxuICAgICAgICByZXR1cm4gb2JqID09IG51bGwgPyB2b2lkIDAgOiBvYmpba2V5XTtcbiAgICB9O1xufVxuXG5cbmZ1bmN0aW9uIGdldExlbmd0aChjb2xsZWN0aW9uKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc2hhbGxvd1Byb3BlcnR5KCdsZW5ndGgnKShjb2xsZWN0aW9uKVxufVxuXG5cbmZ1bmN0aW9uIGFueShjb2xsZWN0aW9uOiBhbnlbXSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBjb2xsZWN0aW9uLnNvbWUoaXRlbSA9PiBib29sKGl0ZW0pKTtcbn1cblxuXG5mdW5jdGlvbiBhbGwoYXJyOiBhbnlbXSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBhcnIuZXZlcnkoaXRlbSA9PiBib29sKGl0ZW0pKTtcbn1cblxuXG5mdW5jdGlvbiBzdW0oYXJyOiBhbnlbXSk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IHN1bSA9IDA7XG4gICAgbGV0IGRpcnR5ID0gZmFsc2U7XG4gICAgZm9yICggbGV0IHYgb2YgYXJyICkge1xuICAgICAgICBsZXQgbnVtYmVyID0gZmxvYXQodik7XG4gICAgICAgIGlmICggIWlzTmFOKG51bWJlcikgKSB7XG4gICAgICAgICAgICBkaXJ0eSA9IHRydWU7XG4gICAgICAgICAgICBzdW0gKz0gbnVtYmVyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbiAgICByZXR1cm4gIWRpcnR5ID8gdW5kZWZpbmVkIDogc3VtO1xufVxuXG5mdW5jdGlvbiBnZXRDdXJyZW50V2luZG93KCkge1xuICAgIHJldHVybiByZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpO1xufVxuXG5mdW5jdGlvbiByZWxvYWRQYWdlKCkge1xuICAgIGdldEN1cnJlbnRXaW5kb3coKS5yZWxvYWQoKTtcbn1cblxuZXhwb3J0IHsgYW55LCBhbGwsIGJvb2wsIHJlbG9hZFBhZ2UsIGludCwgZW51bWVyYXRlLCBpc0Z1bmN0aW9uLCBpc09iamVjdCwgd2FpdCwgc3VtLCBzdHIgfVxuIl19