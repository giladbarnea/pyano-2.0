"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const electron_1 = require("electron");
function round(n, d = 0) {
    const fr = 10 ** d;
    return int(n * fr) / fr;
}
function float(str) {
    return parseFloat(str);
}
function int(x, base) {
    return parseInt(x, base);
}
exports.int = int;
function str(val) {
    return val ? val.toString() : "";
}
exports.str = str;
function bool(val) {
    if (val === null)
        return false;
    const typeofval = typeof val;
    if (typeofval !== 'object') {
        if (typeofval === 'function')
            return true;
        else
            return !!val;
    }
    return Object.keys(val).length !== 0;
}
exports.bool = bool;
function enumerate(obj) {
    let typeofObj = typeof obj;
    if (obj === undefined
        || isEmptyObj(obj)
        || isEmptyArr(obj)
        || obj === "") {
        return [];
    }
    if (obj === null
        || typeofObj === "boolean"
        || typeofObj === "number"
        || typeofObj === "function") {
        throw new TypeError(`${typeofObj} object is not iterable`);
    }
    let array = [];
    if (isArray(obj)) {
        let i = 0;
        for (let x of obj) {
            array.push([i, x]);
            i++;
        }
    }
    else {
        for (let prop in obj) {
            array.push([prop, obj[prop]]);
        }
    }
    return array;
}
exports.enumerate = enumerate;
function wait(ms, acknowledgeSkipFade = true) {
    if (acknowledgeSkipFade) {
        if (require('Glob').skipFade)
            return;
    }
    return new Promise(resolve => setTimeout(resolve, ms));
}
exports.wait = wait;
async function waitUntil(cond, timeout = Infinity, checkInterval = 20) {
    if (checkInterval <= 0)
        throw new Error(`checkInterval <= 0. checkInterval: ${checkInterval}`);
    if (checkInterval > timeout)
        throw new Error(`checkInterval > timeout (${checkInterval} > ${timeout}). Has to be lower than timeout.`);
    const loops = timeout / checkInterval;
    if (loops == 1)
        console.warn(`loops == 1, you probably didn't want this to happen`);
    let count = 0;
    while (count < loops) {
        if (cond()) {
            return true;
        }
        await wait(checkInterval, false);
        count++;
    }
    return false;
}
exports.waitUntil = waitUntil;
let stuff = {
    '()=>{}': () => {
    }, 'function(){}': function () {
    }, 'Function': Function,
    'Function()': Function(),
    "new Function()": new Function(),
    "Boolean": Boolean,
    "Boolean()": Boolean(),
    "new Boolean()": new Boolean(),
    "new Boolean(true)": new Boolean(true),
    "new Boolean(false)": new Boolean(false),
    "true": true,
    "false": false,
    "Number": Number,
    "Number()": Number(),
    "new Number()": new Number(),
    "new Number(0)": new Number(0),
    "new Number(1)": new Number(1),
    "0": 0,
    "1": 1,
    "''": '',
    "' '": ' ',
    "'foo'": 'foo',
    "'0'": '0',
    "'1'": '1',
    "{}": {},
    "{ hi : 'bye' }": { hi: 'bye' },
    "[]": [],
    "[ 1 ]": [1],
    "undefined": undefined,
    "null": null,
};
function notnot(obj) {
    return !!obj;
}
function isArray(obj) {
    if (!obj)
        return false;
    return typeof obj !== 'string' && (Array.isArray(obj) || typeof obj[Symbol.iterator] === 'function');
}
function isEmpty(obj) {
    let toStringed = {}.toString.call(obj);
    return (toStringed === '[object Object]' || toStringed === '[object Array]') && Object.keys(obj).length == 0;
}
function isEmptyArr(collection) {
    return isArray(collection) && getLength(collection) === 0;
}
function isEmptyObj(obj) {
    return isObject(obj) && !isArray(obj) && Object.keys(obj).length === 0;
}
function isFunction(fn) {
    let toStringed = {}.toString.call(fn);
    return !!fn && toStringed === '[object Function]';
}
exports.isFunction = isFunction;
function isTMap(obj) {
    return {}.toString.call(obj) == '[object Object]';
}
function isObject(obj) {
    return typeof obj === 'object' && !!obj;
}
exports.isObject = isObject;
function shallowProperty(key) {
    return function (obj) {
        return obj == null ? void 0 : obj[key];
    };
}
function getLength(collection) {
    return shallowProperty('length')(collection);
}
function any(collection) {
    return collection.some(item => bool(item));
}
exports.any = any;
function all(arr) {
    return arr.every(item => bool(item));
}
exports.all = all;
function sum(arr) {
    let sum = 0;
    let dirty = false;
    for (let v of arr) {
        let number = float(v);
        if (!isNaN(number)) {
            dirty = true;
            sum += number;
        }
    }
    return !dirty ? undefined : sum;
}
exports.sum = sum;
function getCurrentWindow() {
    return electron_1.remote.getCurrentWindow();
}
function reloadPage() {
    getCurrentWindow().reload();
}
exports.reloadPage = reloadPage;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSx1Q0FBa0M7QUFFbEMsU0FBUyxLQUFLLENBQUMsQ0FBUyxFQUFFLElBQVksQ0FBQztJQUNuQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25CLE9BQU8sR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDNUIsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEdBQVc7SUFDdEIsT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDM0IsQ0FBQztBQUVELFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFpQztJQUM3QyxPQUFPLFFBQVEsQ0FBQyxDQUFDLEVBQVcsSUFBSSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQTZkb0Msa0JBQUc7QUEzZHhDLFNBQVMsR0FBRyxDQUFDLEdBQVE7SUFDakIsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ3BDLENBQUM7QUF5ZHFGLGtCQUFHO0FBdmR6RixTQUFTLElBQUksQ0FBQyxHQUFRO0lBNEJsQixJQUFLLEdBQUcsS0FBSyxJQUFJO1FBQ2IsT0FBTyxLQUFLLENBQUM7SUFDakIsTUFBTSxTQUFTLEdBQUcsT0FBTyxHQUFHLENBQUM7SUFDN0IsSUFBSyxTQUFTLEtBQUssUUFBUSxFQUFHO1FBQzFCLElBQUssU0FBUyxLQUFLLFVBQVU7WUFDekIsT0FBTyxJQUFJLENBQUM7O1lBRVosT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDO0tBQ3BCO0lBQ0QsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUM7QUFDekMsQ0FBQztBQWlia0Isb0JBQUk7QUEvYXZCLFNBQVMsU0FBUyxDQUFJLEdBQU07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Q0FBQztBQUV3QixnQ0FBVSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBHbG9iIGZyb20gXCIuL0dsb2JcIjtcbmltcG9ydCB7IHJlbW90ZSB9IGZyb20gJ2VsZWN0cm9uJztcblxuZnVuY3Rpb24gcm91bmQobjogbnVtYmVyLCBkOiBudW1iZXIgPSAwKSB7XG4gICAgY29uc3QgZnIgPSAxMCAqKiBkO1xuICAgIHJldHVybiBpbnQobiAqIGZyKSAvIGZyO1xufVxuXG5mdW5jdGlvbiBmbG9hdChzdHI6IHN0cmluZyk6IG51bWJlciB7XG4gICAgcmV0dXJuIHBhcnNlRmxvYXQoc3RyKTtcbn1cblxuZnVuY3Rpb24gaW50KHgsIGJhc2U/OiBzdHJpbmcgfCBudW1iZXIgfCBGdW5jdGlvbik6IG51bWJlciB7XG4gICAgcmV0dXJuIHBhcnNlSW50KHgsIDxudW1iZXI+IGJhc2UpO1xufVxuXG5mdW5jdGlvbiBzdHIodmFsOiBhbnkpIHtcbiAgICByZXR1cm4gdmFsID8gdmFsLnRvU3RyaW5nKCkgOiBcIlwiXG59XG5cbmZ1bmN0aW9uIGJvb2wodmFsOiBhbnkpOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIDEgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gJzAnICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAnMScgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICgpPT57fSAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gQm9vbGVhbiAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBGdW5jdGlvbiAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIEZ1bmN0aW9uKCkgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gTnVtYmVyICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbIDEgXSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBbXSAgICAgICAgICAgICAgICAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBmdW5jdGlvbigpe30gICAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgICBmYWxzZSAgICAgIGRpZmYgZnJvbSBuYXRpdmVcbiAgICAvLyAvIG5ldyBGdW5jdGlvbigpICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgICBmYWxzZSAgICAgIGRpZmYgZnJvbSBuYXRpdmVcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICAgIGZhbHNlICAgICAgZGlmZiBmcm9tIG5hdGl2ZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gdHJ1ZSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyB7IGhpIDogJ2J5ZScgfSAgICAgIHRydWVcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgICAgZmFsc2UgICAgICBkaWZmIGZyb20gbmF0aXZlXG4gICAgaWYgKCB2YWwgPT09IG51bGwgKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgY29uc3QgdHlwZW9mdmFsID0gdHlwZW9mIHZhbDtcbiAgICBpZiAoIHR5cGVvZnZhbCAhPT0gJ29iamVjdCcgKSB7XG4gICAgICAgIGlmICggdHlwZW9mdmFsID09PSAnZnVuY3Rpb24nIClcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gISF2YWw7XG4gICAgfVxuICAgIHJldHVybiBPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCAhPT0gMDtcbn1cblxuZnVuY3Rpb24gZW51bWVyYXRlPFQ+KG9iajogVCk6IEVudW1lcmF0ZWQ8VD4ge1xuICAgIC8vIHVuZGVmaW5lZCAgICBbXVxuICAgIC8vIHt9ICAgICAgICAgICBbXVxuICAgIC8vIFtdICAgICAgICAgICBbXVxuICAgIC8vIFwiXCIgICAgICAgICAgIFtdXG4gICAgLy8gbnVtYmVyICAgICAgIFR5cGVFcnJvclxuICAgIC8vIG51bGwgICAgICAgICBUeXBlRXJyb3JcbiAgICAvLyBib29sZWFuICAgICAgVHlwZUVycm9yXG4gICAgLy8gRnVuY3Rpb24gICAgIFR5cGVFcnJvclxuICAgIC8vIFwiZm9vXCIgICAgICAgIFsgWzAsIFwiZlwiXSwgWzEsIFwib1wiXSwgWzIsIFwib1wiXSBdXG4gICAgLy8gWyBcImZvb1wiIF0gICAgWyBbMCwgXCJmb29cIl0gXVxuICAgIC8vIFsgMTAgXSAgICAgICBbIFswLCAxMF0gXVxuICAgIC8vIHsgYTogXCJmb29cIiB9IFsgW1wiYVwiLCBcImZvb1wiXSBdXG4gICAgLy8gLy8gKCk9Pnt9ICAgID9cbiAgICBsZXQgdHlwZW9mT2JqID0gdHlwZW9mIG9iajtcbiAgICBpZiAoXG4gICAgICAgIG9iaiA9PT0gdW5kZWZpbmVkXG4gICAgICAgIHx8IGlzRW1wdHlPYmoob2JqKVxuICAgICAgICB8fCBpc0VtcHR5QXJyKG9iailcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB8fCBvYmogPT09IFwiXCJcbiAgICApIHtcbiAgICAgICAgcmV0dXJuIFtdIGFzIEVudW1lcmF0ZWQ8VD47XG4gICAgfVxuICAgIFxuICAgIGlmIChcbiAgICAgICAgb2JqID09PSBudWxsXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgfHwgdHlwZW9mT2JqID09PSBcIm51bWJlclwiXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dHlwZW9mT2JqfSBvYmplY3QgaXMgbm90IGl0ZXJhYmxlYCk7XG4gICAgfVxuICAgIGxldCBhcnJheSA9IFtdO1xuICAgIGlmICggaXNBcnJheShvYmopICkge1xuICAgICAgICBsZXQgaTogbnVtYmVyID0gMDtcbiAgICAgICAgZm9yICggbGV0IHggb2Ygb2JqICkge1xuICAgICAgICAgICAgYXJyYXkucHVzaChbIGksIHggXSk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKCBsZXQgcHJvcCBpbiBvYmogKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKFsgcHJvcCwgb2JqW3Byb3BdIF0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheSBhcyBFbnVtZXJhdGVkPFQ+O1xufVxuXG5mdW5jdGlvbiB3YWl0KG1zOiBudW1iZXIsIGFja25vd2xlZGdlU2tpcEZhZGUgPSB0cnVlKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoIGFja25vd2xlZGdlU2tpcEZhZGUgKSB7XG4gICAgICAgIGlmICggcmVxdWlyZSgnR2xvYicpLnNraXBGYWRlICkgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59XG5cbi8qKkNoZWNrIGV2ZXJ5IGBjaGVja0ludGVydmFsYCBtcyBpZiBgY29uZCgpYCBpcyB0cnV0aHkuIElmLCB3aXRoaW4gYHRpbWVvdXRgLCBjb25kKCkgaXMgdHJ1dGh5LCByZXR1cm4gYHRydWVgLiBSZXR1cm4gYGZhbHNlYCBpZiB0aW1lIGlzIG91dC5cbiAqIEBleGFtcGxlXG4gKiAvLyBHaXZlIHRoZSB1c2VyIGEgMjAwbXMgY2hhbmNlIHRvIGdldCBoZXIgcG9pbnRlciBvdmVyIFwibXlkaXZcIi4gQ29udGludWUgaW1tZWRpYXRlbHkgb25jZSBzaGUgZG9lcywgb3IgYWZ0ZXIgMjAwbXMgaWYgc2hlIGRvZXNuJ3QuXG4gKiBteWRpdi5wb2ludGVyZW50ZXIoICgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZyA9IHRydWU7IClcbiAqIGNvbnN0IHBvaW50ZXJPbk15ZGl2ID0gYXdhaXQgd2FpdFVudGlsKCgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZywgMjAwLCAxMCk7Ki9cbmFzeW5jIGZ1bmN0aW9uIHdhaXRVbnRpbChjb25kOiBGdW5jdGlvblJldHVybnM8Ym9vbGVhbj4sIHRpbWVvdXQ6IG51bWJlciA9IEluZmluaXR5LCBjaGVja0ludGVydmFsOiBudW1iZXIgPSAyMCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICggY2hlY2tJbnRlcnZhbCA8PSAwIClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsIDw9IDAuIGNoZWNrSW50ZXJ2YWw6ICR7Y2hlY2tJbnRlcnZhbH1gKTtcbiAgICBpZiAoIGNoZWNrSW50ZXJ2YWwgPiB0aW1lb3V0IClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsID4gdGltZW91dCAoJHtjaGVja0ludGVydmFsfSA+ICR7dGltZW91dH0pLiBIYXMgdG8gYmUgbG93ZXIgdGhhbiB0aW1lb3V0LmApO1xuICAgIFxuICAgIGNvbnN0IGxvb3BzID0gdGltZW91dCAvIGNoZWNrSW50ZXJ2YWw7XG4gICAgaWYgKCBsb29wcyA9PSAxIClcbiAgICAgICAgY29uc29sZS53YXJuKGBsb29wcyA9PSAxLCB5b3UgcHJvYmFibHkgZGlkbid0IHdhbnQgdGhpcyB0byBoYXBwZW5gKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHdoaWxlICggY291bnQgPCBsb29wcyApIHtcbiAgICAgICAgaWYgKCBjb25kKCkgKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB3YWl0KGNoZWNrSW50ZXJ2YWwsIGZhbHNlKTtcbiAgICAgICAgY291bnQrKztcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG5sZXQgc3R1ZmYgPSB7XG4gICAgJygpPT57fScgOiAoKSA9PiB7XG4gICAgfSwgJ2Z1bmN0aW9uKCl7fScgOiBmdW5jdGlvbiAoKSB7XG4gICAgfSwgJ0Z1bmN0aW9uJyA6IEZ1bmN0aW9uLFxuICAgICdGdW5jdGlvbigpJyA6IEZ1bmN0aW9uKCksXG4gICAgXCJuZXcgRnVuY3Rpb24oKVwiIDogbmV3IEZ1bmN0aW9uKCksXG4gICAgXCJCb29sZWFuXCIgOiBCb29sZWFuLFxuICAgIFwiQm9vbGVhbigpXCIgOiBCb29sZWFuKCksXG4gICAgXCJuZXcgQm9vbGVhbigpXCIgOiBuZXcgQm9vbGVhbigpLFxuICAgIFwibmV3IEJvb2xlYW4odHJ1ZSlcIiA6IG5ldyBCb29sZWFuKHRydWUpLFxuICAgIFwibmV3IEJvb2xlYW4oZmFsc2UpXCIgOiBuZXcgQm9vbGVhbihmYWxzZSksXG4gICAgXCJ0cnVlXCIgOiB0cnVlLFxuICAgIFwiZmFsc2VcIiA6IGZhbHNlLFxuICAgIFwiTnVtYmVyXCIgOiBOdW1iZXIsXG4gICAgXCJOdW1iZXIoKVwiIDogTnVtYmVyKCksXG4gICAgXCJuZXcgTnVtYmVyKClcIiA6IG5ldyBOdW1iZXIoKSxcbiAgICBcIm5ldyBOdW1iZXIoMClcIiA6IG5ldyBOdW1iZXIoMCksXG4gICAgXCJuZXcgTnVtYmVyKDEpXCIgOiBuZXcgTnVtYmVyKDEpLFxuICAgIFwiMFwiIDogMCxcbiAgICBcIjFcIiA6IDEsXG4gICAgXCInJ1wiIDogJycsXG4gICAgXCInICdcIiA6ICcgJyxcbiAgICBcIidmb28nXCIgOiAnZm9vJyxcbiAgICBcIicwJ1wiIDogJzAnLFxuICAgIFwiJzEnXCIgOiAnMScsXG4gICAgXCJ7fVwiIDoge30sXG4gICAgXCJ7IGhpIDogJ2J5ZScgfVwiIDogeyBoaSA6ICdieWUnIH0sXG4gICAgXCJbXVwiIDogW10sXG4gICAgXCJbIDEgXVwiIDogWyAxIF0sXG4gICAgXCJ1bmRlZmluZWRcIiA6IHVuZGVmaW5lZCxcbiAgICBcIm51bGxcIiA6IG51bGwsXG59O1xuXG5mdW5jdGlvbiBub3Rub3Qob2JqKSB7XG4gICAgLy8gLyAwICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgIHRydWVcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpIHRydWVcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gIGZhbHNlICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICB0cnVlXG4gICAgLy8gLyAnJyAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgdHJ1ZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICB1bmRlZmluZWQgICAgICAgZmFsc2VcbiAgICAvLyAvICBudWxsICAgICAgICAgICAgZmFsc2VcbiAgICByZXR1cm4gISFvYmo7XG59XG5cbmZ1bmN0aW9uIGlzQXJyYXk8VD4ob2JqKTogb2JqIGlzIEFycmF5PFQ+IHsgLy8gc2FtZSBhcyBBcnJheS5pc0FycmF5XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICdmb28nICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFsgMSBdICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIGlmICggIW9iaiApIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHlwZW9mIG9iaiAhPT0gJ3N0cmluZycgJiYgKEFycmF5LmlzQXJyYXkob2JqKSB8fCB0eXBlb2Ygb2JqW1N5bWJvbC5pdGVyYXRvcl0gPT09ICdmdW5jdGlvbicpO1xufVxuXG5mdW5jdGlvbiBpc0VtcHR5KG9iajogYW55KTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8gLyB7fSAgICAgICAgICAgICAgICB0cnVlXG4gICAgbGV0IHRvU3RyaW5nZWQgPSB7fS50b1N0cmluZy5jYWxsKG9iaik7XG4gICAgcmV0dXJuICh0b1N0cmluZ2VkID09PSAnW29iamVjdCBPYmplY3RdJyB8fCB0b1N0cmluZ2VkID09PSAnW29iamVjdCBBcnJheV0nKSAmJiBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PSAwO1xufVxuXG5mdW5jdGlvbiBpc0VtcHR5QXJyKGNvbGxlY3Rpb24pOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gW10gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgIGZhbHNlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgcmV0dXJuIGlzQXJyYXkoY29sbGVjdGlvbikgJiYgZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pID09PSAwXG59XG5cbmZ1bmN0aW9uIGlzRW1wdHlPYmoob2JqKTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbXSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBCb29sZWFuKCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBCb29sZWFuKGZhbHNlKXRydWVcbiAgICAvLyAvIG5ldyBCb29sZWFuKHRydWUpIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgTnVtYmVyKDApICAgICB0cnVlXG4gICAgLy8gLyBuZXcgTnVtYmVyKDEpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgTnVtYmVyKCkgICAgICB0cnVlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIC8ge30gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIHJldHVybiBpc09iamVjdChvYmopICYmICFpc0FycmF5KG9iaikgJiYgT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDBcbn1cblxuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uPFQ+KGZuOiBGdW5jdGlvblJldHVybnM8VD4pOiBmbiBpcyBGdW5jdGlvblJldHVybnM8VD5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oZm46IEFueUZ1bmN0aW9uKTogZm4gaXMgQW55RnVuY3Rpb25cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oZm4pIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvICgpPT57fSAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gQm9vbGVhbiAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gRnVuY3Rpb24gICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBGdW5jdGlvbigpICAgICAgICAgIHRydWVcbiAgICAvLyAvIE51bWJlciAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIGZ1bmN0aW9uKCl7fSAgICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIC8gbmV3IEZ1bmN0aW9uKCkgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBsZXQgdG9TdHJpbmdlZCA9IHt9LnRvU3RyaW5nLmNhbGwoZm4pO1xuICAgIHJldHVybiAhIWZuICYmIHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSdcbn1cblxuZnVuY3Rpb24gaXNUTWFwPFQ+KG9iajogVE1hcDxUPik6IG9iaiBpcyBUTWFwPFQ+IHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbXSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSlmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpIGZhbHNlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8geyBoaSA6ICdieWUnIH0gICAgdHJ1ZVxuICAgIC8vIC8ge30gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIHJldHVybiB7fS50b1N0cmluZy5jYWxsKG9iaikgPT0gJ1tvYmplY3QgT2JqZWN0XSdcbn1cblxuLy8gKiAgdW5kZXJzY29yZS5qc1xuZnVuY3Rpb24gaXNPYmplY3Qob2JqKTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gWyAxIF0gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gW10gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgQm9vbGVhbigpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbihmYWxzZSl0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbih0cnVlKSB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IE51bWJlcigwKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigxKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigpICAgICAgdHJ1ZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8geyBoaSA6ICdieWUnIH0gICAgdHJ1ZVxuICAgIC8vIC8ge30gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiAhIW9iajtcbn1cblxuXG5mdW5jdGlvbiBzaGFsbG93UHJvcGVydHk8VD4oa2V5OiBzdHJpbmcpOiAob2JqOiBUKSA9PiBUIGV4dGVuZHMgbnVsbCA/IHVuZGVmaW5lZCA6IFRba2V5b2YgVF0ge1xuICAgIHJldHVybiBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIC8vID09IG51bGwgdHJ1ZSBmb3IgdW5kZWZpbmVkXG4gICAgICAgIHJldHVybiBvYmogPT0gbnVsbCA/IHZvaWQgMCA6IG9ialtrZXldO1xuICAgIH07XG59XG5cblxuZnVuY3Rpb24gZ2V0TGVuZ3RoKGNvbGxlY3Rpb24pOiBudW1iZXIge1xuICAgIHJldHVybiBzaGFsbG93UHJvcGVydHkoJ2xlbmd0aCcpKGNvbGxlY3Rpb24pXG59XG5cblxuZnVuY3Rpb24gYW55KGNvbGxlY3Rpb246IGFueVtdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGNvbGxlY3Rpb24uc29tZShpdGVtID0+IGJvb2woaXRlbSkpO1xufVxuXG5cbmZ1bmN0aW9uIGFsbChhcnI6IGFueVtdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGFyci5ldmVyeShpdGVtID0+IGJvb2woaXRlbSkpO1xufVxuXG5cbmZ1bmN0aW9uIHN1bShhcnI6IGFueVtdKTogbnVtYmVyIHwgdW5kZWZpbmVkIHtcbiAgICBsZXQgc3VtID0gMDtcbiAgICBsZXQgZGlydHkgPSBmYWxzZTtcbiAgICBmb3IgKCBsZXQgdiBvZiBhcnIgKSB7XG4gICAgICAgIGxldCBudW1iZXIgPSBmbG9hdCh2KTtcbiAgICAgICAgaWYgKCAhaXNOYU4obnVtYmVyKSApIHtcbiAgICAgICAgICAgIGRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIHN1bSArPSBudW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuICAgIHJldHVybiAhZGlydHkgPyB1bmRlZmluZWQgOiBzdW07XG59XG5cbmZ1bmN0aW9uIGdldEN1cnJlbnRXaW5kb3coKSB7XG4gICAgcmV0dXJuIHJlbW90ZS5nZXRDdXJyZW50V2luZG93KCk7XG59XG5cbmZ1bmN0aW9uIHJlbG9hZFBhZ2UoKSB7XG4gICAgZ2V0Q3VycmVudFdpbmRvdygpLnJlbG9hZCgpO1xufVxuXG5leHBvcnQgeyBhbnksIGFsbCwgYm9vbCwgcmVsb2FkUGFnZSwgaW50LCBlbnVtZXJhdGUsIGlzRnVuY3Rpb24sIGlzT2JqZWN0LCB3YWl0LCBzdW0sIHN0ciwgd2FpdFVudGlsIH1cbiJdfQ==