"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const electron_1 = require("electron");
const fs = require("fs");
const path = require("path");
const MyFs_1 = require("./MyFs");
function round(n, d = 0) {
    const fr = 10 ** d;
    return parseInt(n * fr) / fr;
}
function int(x, base) {
    return parseInt(x, base);
}
function str(val) {
    return val ? val.toString() : "";
}
exports.str = str;
function bool(val) {
    if (!val)
        return false;
    const typeofval = typeof val;
    if (typeofval !== 'object') {
        if (typeofval === 'function')
            return true;
        else
            return !!val;
    }
    let toStringed = {}.toString.call(val);
    if (toStringed === '[object Object]' || toStringed === '[object Array]')
        return Object.keys(val).length !== 0;
    return !!val.valueOf();
}
exports.bool = bool;
function enumerate(obj) {
    let typeofObj = typeof obj;
    if (obj === undefined
        || isEmptyObj(obj)
        || isEmptyArr(obj)
        || obj === "") {
        return [];
    }
    if (obj === null
        || typeofObj === "boolean"
        || typeofObj === "number"
        || typeofObj === "function") {
        throw new TypeError(`${typeofObj} object is not iterable`);
    }
    let array = [];
    if (isArray(obj)) {
        let i = 0;
        for (let x of obj) {
            array.push([i, x]);
            i++;
        }
    }
    else {
        for (let prop in obj) {
            array.push([prop, obj[prop]]);
        }
    }
    return array;
}
exports.enumerate = enumerate;
function wait(ms, acknowledgeSkipFade = true) {
    if (acknowledgeSkipFade) {
        if (require('./Glob').default.skipFade) {
            console.warn(`skipFade!`);
            return;
        }
    }
    if (!bool(ms)) {
        console.warn(`util.wait(${ms})`);
    }
    return new Promise(resolve => setTimeout(resolve, ms));
}
exports.wait = wait;
async function waitUntil(cond, checkInterval = 20, timeout = Infinity) {
    if (checkInterval <= 0)
        throw new Error(`checkInterval <= 0. checkInterval: ${checkInterval}`);
    if (checkInterval > timeout)
        throw new Error(`checkInterval > timeout (${checkInterval} > ${timeout}). Has to be lower than timeout.`);
    const loops = timeout / checkInterval;
    if (loops == 1)
        console.warn(`loops == 1, you probably didn't want this to happen`);
    let count = 0;
    while (count < loops) {
        if (cond()) {
            return true;
        }
        await wait(checkInterval, false);
        count++;
    }
    return false;
}
exports.waitUntil = waitUntil;
let stuff = {
    '()=>{}': () => {
    }, 'function(){}': function () {
    }, 'Function': Function,
    'Function()': Function(),
    "new Function": new Function,
    "new Function()": new Function(),
    "Boolean": Boolean,
    "Boolean()": Boolean(),
    "Boolean(false)": Boolean(false),
    "Boolean(true)": Boolean(true),
    "new Boolean": new Boolean,
    "new Boolean()": new Boolean(),
    "new Boolean(true)": new Boolean(true),
    "new Boolean(false)": new Boolean(false),
    "true": true,
    "false": false,
    "Number": Number,
    "Number()": Number(),
    "Number(0)": Number(0),
    "Number(1)": Number(1),
    "new Number": new Number,
    "new Number()": new Number(),
    "new Number(0)": new Number(0),
    "new Number(1)": new Number(1),
    "0": 0,
    "1": 1,
    "''": '',
    "' '": ' ',
    "'foo'": 'foo',
    "'0'": '0',
    "'1'": '1',
    "{}": {},
    "{ hi : 'bye' }": { hi: 'bye' },
    "[]": [],
    "[ false ]": [false],
    "[ true ]": [true],
    "[ [] ]": [[]],
    "[ 0 ]": [0],
    "[ 1 ]": [1],
    "undefined": undefined,
    "null": null,
    "document.body": document.body,
    "new class{}": new class {
    },
    "new Timeline(...)": "PLACEHOLDER",
};
function notnot(obj) {
    return !!obj;
}
function isString(obj) {
    return typeof obj === "string";
}
exports.isString = isString;
function isArray(obj) {
    if (!obj)
        return false;
    return typeof obj !== 'string' && (Array.isArray(obj) || typeof obj[Symbol.iterator] === 'function');
}
exports.isArray = isArray;
function isEmpty(obj) {
    let toStringed = {}.toString.call(obj);
    return (toStringed === '[object Object]' || toStringed === '[object Array]') && Object.keys(obj).length == 0;
}
function isEmptyArr(collection) {
    return isArray(collection) && getLength(collection) === 0;
}
function isEmptyObj(obj) {
    return isObject(obj) && !isArray(obj) && Object.keys(obj).length === 0;
}
function isFunction(fn) {
    let toStringed = {}.toString.call(fn);
    return !!fn && toStringed === '[object Function]';
}
exports.isFunction = isFunction;
function isTMap(obj) {
    return {}.toString.call(obj) == '[object Object]';
}
function isObject(obj) {
    return typeof obj === 'object' && !!obj;
}
exports.isObject = isObject;
function shallowProperty(key) {
    return function (obj) {
        return obj == null ? void 0 : obj[key];
    };
}
function getLength(collection) {
    return shallowProperty('length')(collection);
}
function any(...args) {
    for (let a of args) {
        if (bool(a)) {
            return true;
        }
    }
    return false;
}
exports.any = any;
function all(...args) {
    for (let a of args) {
        if (!bool(a)) {
            return false;
        }
    }
    return true;
}
exports.all = all;
function sum(arr) {
    let sum = 0;
    let dirty = false;
    for (let v of arr) {
        let number = parseFloat(v);
        if (!isNaN(number)) {
            dirty = true;
            sum += number;
        }
    }
    return !dirty ? undefined : sum;
}
exports.sum = sum;
function getCurrentWindow() {
    return electron_1.remote.getCurrentWindow();
}
exports.getCurrentWindow = getCurrentWindow;
function reloadPage() {
    if (require("./Glob").default.BigConfig.dev.no_reload_on_submit()) {
        return;
    }
    getCurrentWindow().reload();
}
exports.reloadPage = reloadPage;
function* range(start, stop) {
    for (let i = start; i <= stop; i++)
        yield i;
}
exports.range = range;
async function takeScreenshot(dirname) {
    const webContents = electron_1.remote.getCurrentWebContents();
    const image = await webContents.capturePage();
    MyFs_1.default.createIfNotExists(SESSION_PATH_ABS);
    const dirnameAbs = path.join(SESSION_PATH_ABS, dirname);
    MyFs_1.default.createIfNotExists(dirnameAbs);
    const files = { png: undefined, html: undefined };
    if (fs.existsSync(path.join(dirnameAbs, 'page.png'))) {
        files.png = `${dirnameAbs}/page__${new Date().human()}.png`;
    }
    else {
        files.png = path.join(dirnameAbs, 'page.png');
    }
    fs.writeFileSync(files.png, image.toPNG());
    if (fs.existsSync(path.join(dirnameAbs, 'screenshot.html'))) {
        files.html = `${dirnameAbs}/screenshot__${new Date().human()}.html`;
    }
    else {
        files.html = path.join(dirnameAbs, 'screenshot.html');
    }
    return await webContents.savePage(files.html, "HTMLComplete");
}
exports.takeScreenshot = takeScreenshot;
function ignoreErr(fn) {
    try {
        fn();
    }
    catch (e) {
        console.warn(`IGNORED ERROR: `, e);
    }
}
exports.ignoreErr = ignoreErr;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFJQSx1Q0FBa0M7QUFDbEMseUJBQXlCO0FBQ3pCLDZCQUE2QjtBQUM3QixpQ0FBMEI7QUFHMUIsU0FBUyxLQUFLLENBQUMsQ0FBUyxFQUFFLElBQVksQ0FBQztJQUNuQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBRW5CLE9BQU8sUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDakMsQ0FBQztBQUdELFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFpQztJQUM3QyxPQUFPLFFBQVEsQ0FBQyxDQUFDLEVBQVcsSUFBSSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVELFNBQVMsR0FBRyxDQUFDLEdBQVE7SUFDakIsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ3BDLENBQUM7QUE2a0JHLGtCQUFHO0FBM2tCUCxTQUFTLElBQUksQ0FBQyxHQUFRO0lBK0NsQixJQUFLLENBQUMsR0FBRztRQUNMLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLE1BQU0sU0FBUyxHQUFHLE9BQU8sR0FBRyxDQUFDO0lBQzdCLElBQUssU0FBUyxLQUFLLFFBQVEsRUFBRztRQUMxQixJQUFLLFNBQVMsS0FBSyxVQUFVO1lBQ3pCLE9BQU8sSUFBSSxDQUFDOztZQUVaLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQztLQUNwQjtJQUVELElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3ZDLElBQUssVUFBVSxLQUFLLGlCQUFpQixJQUFJLFVBQVUsS0FBSyxnQkFBZ0I7UUFDcEUsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sS0FB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QUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUMzQyxJQUFLLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsaUJBQWlCLENBQUMsQ0FBQyxFQUFHO1FBQzNELEtBQUssQ0FBQyxJQUFJLEdBQUcsR0FBRyxVQUFVLGdCQUFnQixJQUFJLElBQUksRUFBRSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUE7S0FDdEU7U0FBTTtRQUNILEtBQUssQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztLQUN6RDtJQUNELE9BQU8sTUFBTSxXQUFXLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsY0FBYyxDQUFDLENBQUM7QUFDbEUsQ0FBQztBQTBCRyx3Q0FBYztBQXhCbEIsU0FBUyxTQUFTLENBQUMsRUFBZ0I7SUFDL0IsSUFBSTtRQUNBLEVBQUUsRUFBRSxDQUFDO0tBRVI7SUFBQyxPQUFRLENBQUMsRUFBRztRQUNWLE9BQU8sQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDLENBQUM7S0FDdEM7QUFDTCxDQUFDO0FBUUcsOEJBQVMiLCJzb3VyY2VzQ29udGVudCI6WyIvKippbXBvcnQgKiBhcyB1dGlsIGZyb20gXCIuLi91dGlsXCJcbiAqIHV0aWwucmVsb2FkUGFnZSgpO1xuICpcbiAqIGltcG9ydCB7cmVsb2FkUGFnZX0gZnJvbSBcIi4uL3V0aWxcIiovXG5pbXBvcnQgeyByZW1vdGUgfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQgKiBhcyBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCAqIGFzIHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBteWZzIGZyb20gXCIuL015RnNcIjtcblxuXG5mdW5jdGlvbiByb3VuZChuOiBudW1iZXIsIGQ6IG51bWJlciA9IDApIHtcbiAgICBjb25zdCBmciA9IDEwICoqIGQ7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHJldHVybiBwYXJzZUludChuICogZnIpIC8gZnI7XG59XG5cblxuZnVuY3Rpb24gaW50KHgsIGJhc2U/OiBzdHJpbmcgfCBudW1iZXIgfCBGdW5jdGlvbik6IG51bWJlciB7XG4gICAgcmV0dXJuIHBhcnNlSW50KHgsIDxudW1iZXI+IGJhc2UpO1xufVxuXG5mdW5jdGlvbiBzdHIodmFsOiBhbnkpIHtcbiAgICByZXR1cm4gdmFsID8gdmFsLnRvU3RyaW5nKCkgOiBcIlwiXG59XG5cbmZ1bmN0aW9uIGJvb2wodmFsOiBhbnkpOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICdmb28nICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbihmYWxzZSkgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKHRydWUpICAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKDApICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoMSkgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDAgXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFsgW10gXSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBbIGZhbHNlIF0gICAgICAgICAgICB0cnVlXG4gICAgLy8gWyB0cnVlIF0gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBkb2N1bWVudC5ib2R5ICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4gICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICAgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbiAgICAgICAgIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlciAgICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBUaW1lbGluZSguLi4pICAgIHRydWVcbiAgICAvLyBuZXcgY2xhc3N7fSAgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgICB0cnVlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIFxuICAgIFxuICAgIGlmICggIXZhbCApXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCB0eXBlb2Z2YWwgPSB0eXBlb2YgdmFsO1xuICAgIGlmICggdHlwZW9mdmFsICE9PSAnb2JqZWN0JyApIHtcbiAgICAgICAgaWYgKCB0eXBlb2Z2YWwgPT09ICdmdW5jdGlvbicgKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiAhIXZhbDtcbiAgICB9XG4gICAgLy8gbGV0IGtleXNMZW5ndGggPSBPYmplY3Qua2V5cyh2YWwpLmxlbmd0aDtcbiAgICBsZXQgdG9TdHJpbmdlZCA9IHt9LnRvU3RyaW5nLmNhbGwodmFsKTtcbiAgICBpZiAoIHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IE9iamVjdF0nIHx8IHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IEFycmF5XScgKVxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModmFsKS5sZW5ndGggIT09IDA7XG4gICAgXG4gICAgLy8gQm9vbGVhbiwgTnVtYmVyLCBIVE1MRWxlbWVudC4uLlxuICAgIHJldHVybiAhIXZhbC52YWx1ZU9mKCk7XG59XG5cbmZ1bmN0aW9uIGVudW1lcmF0ZTxUPihvYmo6IFQpOiBFbnVtZXJhdGVkPFQ+IHtcbiAgICAvLyB1bmRlZmluZWQgICAgW11cbiAgICAvLyB7fSAgICAgICAgICAgW11cbiAgICAvLyBbXSAgICAgICAgICAgW11cbiAgICAvLyBcIlwiICAgICAgICAgICBbXVxuICAgIC8vIG51bWJlciAgICAgICBUeXBlRXJyb3JcbiAgICAvLyBudWxsICAgICAgICAgVHlwZUVycm9yXG4gICAgLy8gYm9vbGVhbiAgICAgIFR5cGVFcnJvclxuICAgIC8vIEZ1bmN0aW9uICAgICBUeXBlRXJyb3JcbiAgICAvLyBcImZvb1wiICAgICAgICBbIFswLCBcImZcIl0sIFsxLCBcIm9cIl0sIFsyLCBcIm9cIl0gXVxuICAgIC8vIFsgXCJmb29cIiBdICAgIFsgWzAsIFwiZm9vXCJdIF1cbiAgICAvLyBbIDEwIF0gICAgICAgWyBbMCwgMTBdIF1cbiAgICAvLyB7IGE6IFwiZm9vXCIgfSBbIFtcImFcIiwgXCJmb29cIl0gXVxuICAgIC8vIC8vICgpPT57fSAgICA/XG4gICAgbGV0IHR5cGVvZk9iaiA9IHR5cGVvZiBvYmo7XG4gICAgaWYgKFxuICAgICAgICBvYmogPT09IHVuZGVmaW5lZFxuICAgICAgICB8fCBpc0VtcHR5T2JqKG9iailcbiAgICAgICAgfHwgaXNFbXB0eUFycihvYmopXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgfHwgb2JqID09PSBcIlwiXG4gICAgKSB7XG4gICAgICAgIHJldHVybiBbXSBhcyBFbnVtZXJhdGVkPFQ+O1xuICAgIH1cbiAgICBcbiAgICBpZiAoXG4gICAgICAgIG9iaiA9PT0gbnVsbFxuICAgICAgICB8fCB0eXBlb2ZPYmogPT09IFwiYm9vbGVhblwiXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJudW1iZXJcIlxuICAgICAgICB8fCB0eXBlb2ZPYmogPT09IFwiZnVuY3Rpb25cIlxuICAgICkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke3R5cGVvZk9ian0gb2JqZWN0IGlzIG5vdCBpdGVyYWJsZWApO1xuICAgIH1cbiAgICBsZXQgYXJyYXkgPSBbXTtcbiAgICBpZiAoIGlzQXJyYXkob2JqKSApIHtcbiAgICAgICAgbGV0IGk6IG51bWJlciA9IDA7XG4gICAgICAgIGZvciAoIGxldCB4IG9mIG9iaiApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2goWyBpLCB4IF0pO1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICggbGV0IHByb3AgaW4gb2JqICkge1xuICAgICAgICAgICAgYXJyYXkucHVzaChbIHByb3AsIG9ialtwcm9wXSBdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyYXkgYXMgRW51bWVyYXRlZDxUPjtcbn1cblxuZnVuY3Rpb24gd2FpdChtczogbnVtYmVyLCBhY2tub3dsZWRnZVNraXBGYWRlID0gdHJ1ZSk6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKCBhY2tub3dsZWRnZVNraXBGYWRlICkge1xuICAgICAgICBcbiAgICAgICAgaWYgKCByZXF1aXJlKCcuL0dsb2InKS5kZWZhdWx0LnNraXBGYWRlICkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBza2lwRmFkZSFgKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiAoIEdsb2Iuc2tpcEZhZGUgKSByZXR1cm47XG4gICAgfVxuICAgIGlmICggIWJvb2wobXMpICkge1xuICAgICAgICBjb25zb2xlLndhcm4oYHV0aWwud2FpdCgke21zfSlgKVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XG59XG5cbi8qKkNoZWNrIGV2ZXJ5IGBjaGVja0ludGVydmFsYCBtcyBpZiBgY29uZCgpYCBpcyB0cnV0aHkuIElmLCB3aXRoaW4gYHRpbWVvdXRgLCBjb25kKCkgaXMgdHJ1dGh5LCByZXR1cm4gYHRydWVgLiBSZXR1cm4gYGZhbHNlYCBpZiB0aW1lIGlzIG91dC5cbiAqIEBleGFtcGxlXG4gKiAvLyBHaXZlIHRoZSB1c2VyIGEgMjAwbXMgY2hhbmNlIHRvIGdldCBoZXIgcG9pbnRlciBvdmVyIFwibXlkaXZcIi4gQ29udGludWUgaW1tZWRpYXRlbHkgb25jZSBzaGUgZG9lcywgb3IgYWZ0ZXIgMjAwbXMgaWYgc2hlIGRvZXNuJ3QuXG4gKiBteWRpdi5wb2ludGVyZW50ZXIoICgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZyA9IHRydWU7IClcbiAqIGNvbnN0IHBvaW50ZXJPbk15ZGl2ID0gYXdhaXQgd2FpdFVudGlsKCgpID0+IG15ZGl2LnBvaW50ZXJIb3ZlcmluZywgMjAwLCAxMCk7Ki9cbmFzeW5jIGZ1bmN0aW9uIHdhaXRVbnRpbChjb25kOiBGdW5jdGlvblJldHVybnM8Ym9vbGVhbj4sIGNoZWNrSW50ZXJ2YWw6IG51bWJlciA9IDIwLCB0aW1lb3V0OiBudW1iZXIgPSBJbmZpbml0eSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICggY2hlY2tJbnRlcnZhbCA8PSAwIClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsIDw9IDAuIGNoZWNrSW50ZXJ2YWw6ICR7Y2hlY2tJbnRlcnZhbH1gKTtcbiAgICBpZiAoIGNoZWNrSW50ZXJ2YWwgPiB0aW1lb3V0IClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBjaGVja0ludGVydmFsID4gdGltZW91dCAoJHtjaGVja0ludGVydmFsfSA+ICR7dGltZW91dH0pLiBIYXMgdG8gYmUgbG93ZXIgdGhhbiB0aW1lb3V0LmApO1xuICAgIFxuICAgIGNvbnN0IGxvb3BzID0gdGltZW91dCAvIGNoZWNrSW50ZXJ2YWw7XG4gICAgaWYgKCBsb29wcyA9PSAxIClcbiAgICAgICAgY29uc29sZS53YXJuKGBsb29wcyA9PSAxLCB5b3UgcHJvYmFibHkgZGlkbid0IHdhbnQgdGhpcyB0byBoYXBwZW5gKTtcbiAgICBsZXQgY291bnQgPSAwO1xuICAgIHdoaWxlICggY291bnQgPCBsb29wcyApIHtcbiAgICAgICAgaWYgKCBjb25kKCkgKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB3YWl0KGNoZWNrSW50ZXJ2YWwsIGZhbHNlKTtcbiAgICAgICAgY291bnQrKztcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG5sZXQgc3R1ZmYgPSB7XG4gICAgJygpPT57fScgOiAoKSA9PiB7XG4gICAgfSwgJ2Z1bmN0aW9uKCl7fScgOiBmdW5jdGlvbiAoKSB7XG4gICAgfSwgJ0Z1bmN0aW9uJyA6IEZ1bmN0aW9uLFxuICAgICdGdW5jdGlvbigpJyA6IEZ1bmN0aW9uKCksXG4gICAgXCJuZXcgRnVuY3Rpb25cIiA6IG5ldyBGdW5jdGlvbixcbiAgICBcIm5ldyBGdW5jdGlvbigpXCIgOiBuZXcgRnVuY3Rpb24oKSxcbiAgICBcIkJvb2xlYW5cIiA6IEJvb2xlYW4sXG4gICAgXCJCb29sZWFuKClcIiA6IEJvb2xlYW4oKSxcbiAgICBcIkJvb2xlYW4oZmFsc2UpXCIgOiBCb29sZWFuKGZhbHNlKSxcbiAgICBcIkJvb2xlYW4odHJ1ZSlcIiA6IEJvb2xlYW4odHJ1ZSksXG4gICAgXCJuZXcgQm9vbGVhblwiIDogbmV3IEJvb2xlYW4sXG4gICAgXCJuZXcgQm9vbGVhbigpXCIgOiBuZXcgQm9vbGVhbigpLFxuICAgIFwibmV3IEJvb2xlYW4odHJ1ZSlcIiA6IG5ldyBCb29sZWFuKHRydWUpLFxuICAgIFwibmV3IEJvb2xlYW4oZmFsc2UpXCIgOiBuZXcgQm9vbGVhbihmYWxzZSksXG4gICAgXCJ0cnVlXCIgOiB0cnVlLFxuICAgIFwiZmFsc2VcIiA6IGZhbHNlLFxuICAgIFwiTnVtYmVyXCIgOiBOdW1iZXIsXG4gICAgXCJOdW1iZXIoKVwiIDogTnVtYmVyKCksXG4gICAgXCJOdW1iZXIoMClcIiA6IE51bWJlcigwKSxcbiAgICBcIk51bWJlcigxKVwiIDogTnVtYmVyKDEpLFxuICAgIFwibmV3IE51bWJlclwiIDogbmV3IE51bWJlcixcbiAgICBcIm5ldyBOdW1iZXIoKVwiIDogbmV3IE51bWJlcigpLFxuICAgIFwibmV3IE51bWJlcigwKVwiIDogbmV3IE51bWJlcigwKSxcbiAgICBcIm5ldyBOdW1iZXIoMSlcIiA6IG5ldyBOdW1iZXIoMSksXG4gICAgXCIwXCIgOiAwLFxuICAgIFwiMVwiIDogMSxcbiAgICBcIicnXCIgOiAnJyxcbiAgICBcIicgJ1wiIDogJyAnLFxuICAgIFwiJ2ZvbydcIiA6ICdmb28nLFxuICAgIFwiJzAnXCIgOiAnMCcsXG4gICAgXCInMSdcIiA6ICcxJyxcbiAgICBcInt9XCIgOiB7fSxcbiAgICBcInsgaGkgOiAnYnllJyB9XCIgOiB7IGhpIDogJ2J5ZScgfSxcbiAgICBcIltdXCIgOiBbXSxcbiAgICBcIlsgZmFsc2UgXVwiIDogWyBmYWxzZSBdLFxuICAgIFwiWyB0cnVlIF1cIiA6IFsgdHJ1ZSBdLFxuICAgIFwiWyBbXSBdXCIgOiBbIFtdIF0sXG4gICAgXCJbIDAgXVwiIDogWyAwIF0sXG4gICAgXCJbIDEgXVwiIDogWyAxIF0sXG4gICAgXCJ1bmRlZmluZWRcIiA6IHVuZGVmaW5lZCxcbiAgICBcIm51bGxcIiA6IG51bGwsXG4gICAgXCJkb2N1bWVudC5ib2R5XCIgOiBkb2N1bWVudC5ib2R5LFxuICAgIFwibmV3IGNsYXNze31cIiA6IG5ldyBjbGFzcyB7XG4gICAgfSxcbiAgICBcIm5ldyBUaW1lbGluZSguLi4pXCIgOiBcIlBMQUNFSE9MREVSXCIsXG59O1xuXG5cbmZ1bmN0aW9uIG5vdG5vdChvYmopIHtcbiAgICAvLyAvIDAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgIHRydWVcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgIHRydWVcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gIEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgdHJ1ZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgZmFsc2UgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgIHRydWVcbiAgICAvLyAvICcnICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICB0cnVlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gIHVuZGVmaW5lZCAgICAgICBmYWxzZVxuICAgIC8vIC8gIG51bGwgICAgICAgICAgICBmYWxzZVxuICAgIHJldHVybiAhIW9iajtcbn1cblxuZnVuY3Rpb24gaXNTdHJpbmcob2JqKTogb2JqIGlzIHN0cmluZyB7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwic3RyaW5nXCJcbn1cblxuZnVuY3Rpb24gaXNBcnJheTxUPihvYmopOiBvYmogaXMgQXJyYXk8VD4geyAvLyBzYW1lIGFzIEFycmF5LmlzQXJyYXlcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJ2ZvbycgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gWyAxIF0gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gW10gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgIGZhbHNlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgaWYgKCAhb2JqICkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0eXBlb2Ygb2JqICE9PSAnc3RyaW5nJyAmJiAoQXJyYXkuaXNBcnJheShvYmopIHx8IHR5cGVvZiBvYmpbU3ltYm9sLml0ZXJhdG9yXSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5cbmZ1bmN0aW9uIGlzRW1wdHkob2JqOiBhbnkpOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gW10gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgIGZhbHNlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICBsZXQgdG9TdHJpbmdlZCA9IHt9LnRvU3RyaW5nLmNhbGwob2JqKTtcbiAgICByZXR1cm4gKHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IE9iamVjdF0nIHx8IHRvU3RyaW5nZWQgPT09ICdbb2JqZWN0IEFycmF5XScpICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09IDA7XG59XG5cbmZ1bmN0aW9uIGlzRW1wdHlBcnIoY29sbGVjdGlvbik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICByZXR1cm4gaXNBcnJheShjb2xsZWN0aW9uKSAmJiBnZXRMZW5ndGgoY29sbGVjdGlvbikgPT09IDBcbn1cblxuZnVuY3Rpb24gaXNFbXB0eU9iaihvYmopOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oZmFsc2UpdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4odHJ1ZSkgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBOdW1iZXIoMCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoMSkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoKSAgICAgIHRydWVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8gLyB7fSAgICAgICAgICAgICAgICB0cnVlXG4gICAgcmV0dXJuIGlzT2JqZWN0KG9iaikgJiYgIWlzQXJyYXkob2JqKSAmJiBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PT0gMFxufVxuXG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb248VD4oZm46IEZ1bmN0aW9uUmV0dXJuczxUPik6IGZuIGlzIEZ1bmN0aW9uUmV0dXJuczxUPlxuLy8gZnVuY3Rpb24gaXNGdW5jdGlvbihmbjogQW55RnVuY3Rpb24pOiBmbiBpcyBBbnlGdW5jdGlvblxuZnVuY3Rpb24gaXNGdW5jdGlvbihmbikge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gKCk9Pnt9ICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBCb29sZWFuICAgICAgICAgICAgIHRydWVcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBGdW5jdGlvbiAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIEZ1bmN0aW9uKCkgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gTnVtYmVyICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbXSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIC8gZnVuY3Rpb24oKXt9ICAgICAgICB0cnVlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgIGZhbHNlXG4gICAgLy8gLyBuZXcgRnVuY3Rpb24oKSAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIGxldCB0b1N0cmluZ2VkID0ge30udG9TdHJpbmcuY2FsbChmbik7XG4gICAgcmV0dXJuICEhZm4gJiYgdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJ1xufVxuXG5mdW5jdGlvbiBpc1RNYXA8VD4ob2JqOiBUTWFwPFQ+KTogb2JqIGlzIFRNYXA8VD4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKWZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyB7IGhpIDogJ2J5ZScgfSAgICB0cnVlXG4gICAgLy8gLyB7fSAgICAgICAgICAgICAgICB0cnVlXG4gICAgcmV0dXJuIHt9LnRvU3RyaW5nLmNhbGwob2JqKSA9PSAnW29iamVjdCBPYmplY3RdJ1xufVxuXG4vLyAqICB1bmRlcnNjb3JlLmpzXG5mdW5jdGlvbiBpc09iamVjdChvYmopOiBib29sZWFuIHtcbiAgICAvLyAwICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnICcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbIDEgXSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBCb29sZWFuKCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBCb29sZWFuKGZhbHNlKXRydWVcbiAgICAvLyAvIG5ldyBCb29sZWFuKHRydWUpIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgTnVtYmVyKDApICAgICB0cnVlXG4gICAgLy8gLyBuZXcgTnVtYmVyKDEpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgTnVtYmVyKCkgICAgICB0cnVlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyB7IGhpIDogJ2J5ZScgfSAgICB0cnVlXG4gICAgLy8gLyB7fSAgICAgICAgICAgICAgICB0cnVlXG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmICEhb2JqO1xufVxuXG5cbmZ1bmN0aW9uIHNoYWxsb3dQcm9wZXJ0eTxUPihrZXk6IHN0cmluZyk6IChvYmo6IFQpID0+IFQgZXh0ZW5kcyBudWxsID8gdW5kZWZpbmVkIDogVFtrZXlvZiBUXSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgLy8gPT0gbnVsbCB0cnVlIGZvciB1bmRlZmluZWRcbiAgICAgICAgcmV0dXJuIG9iaiA9PSBudWxsID8gdm9pZCAwIDogb2JqW2tleV07XG4gICAgfTtcbn1cblxuXG5mdW5jdGlvbiBnZXRMZW5ndGgoY29sbGVjdGlvbik6IG51bWJlciB7XG4gICAgcmV0dXJuIHNoYWxsb3dQcm9wZXJ0eSgnbGVuZ3RoJykoY29sbGVjdGlvbilcbn1cblxuXG5mdW5jdGlvbiBhbnkoLi4uYXJnczogYW55W10pOiBib29sZWFuIHtcbiAgICBmb3IgKCBsZXQgYSBvZiBhcmdzICkge1xuICAgICAgICBpZiAoIGJvb2woYSkgKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cblxuZnVuY3Rpb24gYWxsKC4uLmFyZ3M6IGFueSk6IGJvb2xlYW4ge1xuICAgIGZvciAoIGxldCBhIG9mIGFyZ3MgKSB7XG4gICAgICAgIGlmICggIWJvb2woYSkgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5cblxuZnVuY3Rpb24gc3VtKGFycjogYW55W10pOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgIGxldCBzdW0gPSAwO1xuICAgIGxldCBkaXJ0eSA9IGZhbHNlO1xuICAgIGZvciAoIGxldCB2IG9mIGFyciApIHtcbiAgICAgICAgbGV0IG51bWJlciA9IHBhcnNlRmxvYXQodik7XG4gICAgICAgIGlmICggIWlzTmFOKG51bWJlcikgKSB7XG4gICAgICAgICAgICBkaXJ0eSA9IHRydWU7XG4gICAgICAgICAgICBzdW0gKz0gbnVtYmVyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbiAgICByZXR1cm4gIWRpcnR5ID8gdW5kZWZpbmVkIDogc3VtO1xufVxuXG5mdW5jdGlvbiBnZXRDdXJyZW50V2luZG93KCkge1xuICAgIHJldHVybiByZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpO1xufVxuXG5mdW5jdGlvbiByZWxvYWRQYWdlKCkge1xuICAgIGlmICggcmVxdWlyZShcIi4vR2xvYlwiKS5kZWZhdWx0LkJpZ0NvbmZpZy5kZXYubm9fcmVsb2FkX29uX3N1Ym1pdCgpICkge1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgZ2V0Q3VycmVudFdpbmRvdygpLnJlbG9hZCgpO1xufVxuXG5mdW5jdGlvbiogcmFuZ2Uoc3RhcnQ6IG51bWJlciwgc3RvcDogbnVtYmVyKTogR2VuZXJhdG9yPG51bWJlcj4ge1xuICAgIGZvciAoIGxldCBpID0gc3RhcnQ7IGkgPD0gc3RvcDsgaSsrIClcbiAgICAgICAgeWllbGQgaTtcbiAgICBcbn1cblxuLyoqSnVzdCB0aGUgYmFzZW5hbWUqL1xuYXN5bmMgZnVuY3Rpb24gdGFrZVNjcmVlbnNob3QoZGlybmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3Qgd2ViQ29udGVudHMgPSByZW1vdGUuZ2V0Q3VycmVudFdlYkNvbnRlbnRzKCk7XG4gICAgY29uc3QgaW1hZ2UgPSBhd2FpdCB3ZWJDb250ZW50cy5jYXB0dXJlUGFnZSgpO1xuICAgIG15ZnMuY3JlYXRlSWZOb3RFeGlzdHMoU0VTU0lPTl9QQVRIX0FCUyk7XG4gICAgY29uc3QgZGlybmFtZUFicyA9IHBhdGguam9pbihTRVNTSU9OX1BBVEhfQUJTLCBkaXJuYW1lKTtcbiAgICBteWZzLmNyZWF0ZUlmTm90RXhpc3RzKGRpcm5hbWVBYnMpO1xuICAgIGNvbnN0IGZpbGVzID0geyBwbmcgOiB1bmRlZmluZWQsIGh0bWwgOiB1bmRlZmluZWQgfTtcbiAgICBpZiAoIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGRpcm5hbWVBYnMsICdwYWdlLnBuZycpKSApIHtcbiAgICAgICAgZmlsZXMucG5nID0gYCR7ZGlybmFtZUFic30vcGFnZV9fJHtuZXcgRGF0ZSgpLmh1bWFuKCl9LnBuZ2BcbiAgICB9IGVsc2Uge1xuICAgICAgICBmaWxlcy5wbmcgPSBwYXRoLmpvaW4oZGlybmFtZUFicywgJ3BhZ2UucG5nJyk7XG4gICAgfVxuICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZXMucG5nLCBpbWFnZS50b1BORygpKTtcbiAgICBpZiAoIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGRpcm5hbWVBYnMsICdzY3JlZW5zaG90Lmh0bWwnKSkgKSB7XG4gICAgICAgIGZpbGVzLmh0bWwgPSBgJHtkaXJuYW1lQWJzfS9zY3JlZW5zaG90X18ke25ldyBEYXRlKCkuaHVtYW4oKX0uaHRtbGBcbiAgICB9IGVsc2Uge1xuICAgICAgICBmaWxlcy5odG1sID0gcGF0aC5qb2luKGRpcm5hbWVBYnMsICdzY3JlZW5zaG90Lmh0bWwnKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHdlYkNvbnRlbnRzLnNhdmVQYWdlKGZpbGVzLmh0bWwsIFwiSFRNTENvbXBsZXRlXCIpO1xufVxuXG5mdW5jdGlvbiBpZ25vcmVFcnIoZm46IFN5bmNGdW5jdGlvbikge1xuICAgIHRyeSB7XG4gICAgICAgIGZuKCk7XG4gICAgICAgIFxuICAgIH0gY2F0Y2ggKCBlICkge1xuICAgICAgICBjb25zb2xlLndhcm4oYElHTk9SRUQgRVJST1I6IGAsIGUpO1xuICAgIH1cbn1cblxuZXhwb3J0IHtcbiAgICBhbGwsXG4gICAgYW55LFxuICAgIGJvb2wsXG4gICAgZW51bWVyYXRlLFxuICAgIGdldEN1cnJlbnRXaW5kb3csXG4gICAgaWdub3JlRXJyLFxuICAgIGlzQXJyYXksXG4gICAgaXNGdW5jdGlvbixcbiAgICBpc1N0cmluZyxcbiAgICBpc09iamVjdCxcbiAgICByYW5nZSxcbiAgICByZWxvYWRQYWdlLFxuICAgIHN0cixcbiAgICBzdW0sXG4gICAgdGFrZVNjcmVlbnNob3QsXG4gICAgd2FpdCxcbiAgICB3YWl0VW50aWxcbn1cblxuIl19