"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const electron_1 = require("electron");
function round(n, d = 0) {
    const fr = 10 ** d;
    return parseInt(n * fr) / fr;
}
function int(x, base) {
    return parseInt(x, base);
}
function str(val) {
    return val ? val.toString() : "";
}
exports.str = str;
function bool(val) {
    if (!val)
        return false;
    const typeofval = typeof val;
    if (typeofval !== 'object') {
        if (typeofval === 'function')
            return true;
        else
            return !!val;
    }
    let toStringed = {}.toString.call(val);
    if (toStringed === '[object Object]' || toStringed === '[object Array]')
        return Object.keys(val).length !== 0;
    return !!val.valueOf();
}
exports.bool = bool;
function enumerate(obj) {
    let typeofObj = typeof obj;
    if (obj === undefined
        || isEmptyObj(obj)
        || isEmptyArr(obj)
        || obj === "") {
        return [];
    }
    if (obj === null
        || typeofObj === "boolean"
        || typeofObj === "number"
        || typeofObj === "function") {
        throw new TypeError(`${typeofObj} object is not iterable`);
    }
    let array = [];
    if (isArray(obj)) {
        let i = 0;
        for (let x of obj) {
            array.push([i, x]);
            i++;
        }
    }
    else {
        for (let prop in obj) {
            array.push([prop, obj[prop]]);
        }
    }
    return array;
}
exports.enumerate = enumerate;
function wait(ms, acknowledgeSkipFade = true) {
    if (acknowledgeSkipFade) {
        if (require('./Glob').default.skipFade) {
            console.warn(`skipFade!`);
            return;
        }
    }
    if (!bool(ms)) {
        console.warn(`util.wait(${ms})`);
    }
    return new Promise(resolve => setTimeout(resolve, ms));
}
exports.wait = wait;
async function waitUntil(cond, checkInterval = 20, timeout = Infinity) {
    if (checkInterval <= 0)
        throw new Error(`checkInterval <= 0. checkInterval: ${checkInterval}`);
    if (checkInterval > timeout)
        throw new Error(`checkInterval > timeout (${checkInterval} > ${timeout}). Has to be lower than timeout.`);
    const loops = timeout / checkInterval;
    if (loops == 1)
        console.warn(`loops == 1, you probably didn't want this to happen`);
    let count = 0;
    while (count < loops) {
        if (cond()) {
            return true;
        }
        await wait(checkInterval, false);
        count++;
    }
    return false;
}
exports.waitUntil = waitUntil;
let stuff = {
    '()=>{}': () => {
    }, 'function(){}': function () {
    }, 'Function': Function,
    'Function()': Function(),
    "new Function": new Function,
    "new Function()": new Function(),
    "Boolean": Boolean,
    "Boolean()": Boolean(),
    "Boolean(false)": Boolean(false),
    "Boolean(true)": Boolean(true),
    "new Boolean": new Boolean,
    "new Boolean()": new Boolean(),
    "new Boolean(true)": new Boolean(true),
    "new Boolean(false)": new Boolean(false),
    "true": true,
    "false": false,
    "Number": Number,
    "Number()": Number(),
    "Number(0)": Number(0),
    "Number(1)": Number(1),
    "new Number": new Number,
    "new Number()": new Number(),
    "new Number(0)": new Number(0),
    "new Number(1)": new Number(1),
    "0": 0,
    "1": 1,
    "''": '',
    "' '": ' ',
    "'foo'": 'foo',
    "'0'": '0',
    "'1'": '1',
    "{}": {},
    "{ hi : 'bye' }": { hi: 'bye' },
    "[]": [],
    "[ false ]": [false],
    "[ true ]": [true],
    "[ [] ]": [[]],
    "[ 0 ]": [0],
    "[ 1 ]": [1],
    "undefined": undefined,
    "null": null,
    "document.body": document.body,
    "new class{}": new class {
    },
    "new Timeline(...)": "PLACEHOLDER",
};
function notnot(obj) {
    return !!obj;
}
function isArray(obj) {
    if (!obj)
        return false;
    return typeof obj !== 'string' && (Array.isArray(obj) || typeof obj[Symbol.iterator] === 'function');
}
exports.isArray = isArray;
function isEmpty(obj) {
    let toStringed = {}.toString.call(obj);
    return (toStringed === '[object Object]' || toStringed === '[object Array]') && Object.keys(obj).length == 0;
}
function isEmptyArr(collection) {
    return isArray(collection) && getLength(collection) === 0;
}
function isEmptyObj(obj) {
    return isObject(obj) && !isArray(obj) && Object.keys(obj).length === 0;
}
function isFunction(fn) {
    let toStringed = {}.toString.call(fn);
    return !!fn && toStringed === '[object Function]';
}
exports.isFunction = isFunction;
function isTMap(obj) {
    return {}.toString.call(obj) == '[object Object]';
}
function isObject(obj) {
    return typeof obj === 'object' && !!obj;
}
exports.isObject = isObject;
function shallowProperty(key) {
    return function (obj) {
        return obj == null ? void 0 : obj[key];
    };
}
function getLength(collection) {
    return shallowProperty('length')(collection);
}
function any(...args) {
    for (let a of args) {
        if (bool(a)) {
            return true;
        }
    }
    return false;
}
exports.any = any;
function all(...args) {
    for (let a of args) {
        if (!bool(a)) {
            return false;
        }
    }
    return true;
}
exports.all = all;
function sum(arr) {
    let sum = 0;
    let dirty = false;
    for (let v of arr) {
        let number = parseFloat(v);
        if (!isNaN(number)) {
            dirty = true;
            sum += number;
        }
    }
    return !dirty ? undefined : sum;
}
exports.sum = sum;
function getCurrentWindow() {
    return electron_1.remote.getCurrentWindow();
}
exports.getCurrentWindow = getCurrentWindow;
function reloadPage() {
    if (require("./Glob").default.BigConfig.dev.no_reload_on_submit()) {
        return console.warn('reloadPage(), no_reload_on_submit()');
    }
    getCurrentWindow().reload();
}
exports.reloadPage = reloadPage;
function* range(start, stop) {
    for (let i = start; i <= stop; i++)
        yield i;
}
exports.range = range;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFJQSx1Q0FBa0M7QUFJbEMsU0FBUyxLQUFLLENBQUMsQ0FBUyxFQUFFLElBQVksQ0FBQztJQUNuQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBRW5CLE9BQU8sUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDakMsQ0FBQztBQUdELFNBQVMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFpQztJQUM3QyxPQUFPLFFBQVEsQ0FBQyxDQUFDLEVBQVcsSUFBSSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVELFNBQVMsR0FBRyxDQUFDLEdBQVE7SUFDakIsT0FBTyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFBO0FBQ3BDLENBQUM7QUF5aUJHLGtCQUFHO0FBdmlCUCxTQUFTLElBQUksQ0FBQyxHQUFRO0lBK0NsQixJQUFLLENBQUMsR0FBRztRQUNMLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLE1BQU0sU0FBUyxHQUFHLE9BQU8sR0FBRyxDQUFDO0lBQzdCLElBQUssU0FBUyxLQUFLLFFBQVEsRUFBRztRQUMxQixJQUFLLFNBQVMsS0FBSyxVQUFVO1lBQ3pCLE9BQU8sSUFBSSxDQUFDOztZQUVaLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQztLQUNwQjtJQUVELElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3ZDLElBQUssVUFBVSxLQUFLLGlCQUFpQixJQUFJLFVBQVUsS0FBSyxnQkFBZ0I7UUFDcEUsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUM7SUFHekMsT0FBTyxDQUFDLENBQUMsR0FBRyxD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LENBQUM7QUFtQkcsZ0NBQVU7QUFqQmQsUUFBUSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQWEsRUFBRSxJQUFZO0lBQ3ZDLEtBQU0sSUFBSSxDQUFDLEdBQUcsS0FBSyxFQUFFLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxFQUFFO1FBQy9CLE1BQU0sQ0FBQyxDQUFDO0FBRWhCLENBQUM7QUFZRyxzQkFBSyIsInNvdXJjZXNDb250ZW50IjpbIi8qKmltcG9ydCAqIGFzIHV0aWwgZnJvbSBcIi4uL3V0aWxcIlxuICogdXRpbC5yZWxvYWRQYWdlKCk7XG4gKlxuICogaW1wb3J0IHtyZWxvYWRQYWdlfSBmcm9tIFwiLi4vdXRpbFwiKi9cbmltcG9ydCB7IHJlbW90ZSB9IGZyb20gJ2VsZWN0cm9uJztcbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuXG5cbmZ1bmN0aW9uIHJvdW5kKG46IG51bWJlciwgZDogbnVtYmVyID0gMCkge1xuICAgIGNvbnN0IGZyID0gMTAgKiogZDtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgcmV0dXJuIHBhcnNlSW50KG4gKiBmcikgLyBmcjtcbn1cblxuXG5mdW5jdGlvbiBpbnQoeCwgYmFzZT86IHN0cmluZyB8IG51bWJlciB8IEZ1bmN0aW9uKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcGFyc2VJbnQoeCwgPG51bWJlcj4gYmFzZSk7XG59XG5cbmZ1bmN0aW9uIHN0cih2YWw6IGFueSkge1xuICAgIHJldHVybiB2YWwgPyB2YWwudG9TdHJpbmcoKSA6IFwiXCJcbn1cblxuZnVuY3Rpb24gYm9vbCh2YWw6IGFueSk6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gMSAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICcnICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJ2ZvbycgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKGZhbHNlKSAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4odHJ1ZSkgICAgICAgIHRydWVcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICAgdHJ1ZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIoMCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigxKSAgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMCBdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gWyBbXSBdICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFsgZmFsc2UgXSAgICAgICAgICAgIHRydWVcbiAgICAvLyBbIHRydWUgXSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIGRvY3VtZW50LmJvZHkgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbiAgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgICB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uICAgICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyICAgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICAgZmFsc2UgICAgICAgdW5saWtlIG5hdGl2ZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgLy8gbmV3IFRpbWVsaW5lKC4uLikgICAgdHJ1ZVxuICAgIC8vIG5ldyBjbGFzc3t9ICAgICAgICAgIGZhbHNlICAgICAgIHVubGlrZSBuYXRpdmVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgIHRydWVcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgICBmYWxzZSAgICAgICB1bmxpa2UgbmF0aXZlXG4gICAgXG4gICAgXG4gICAgaWYgKCAhdmFsIClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHR5cGVvZnZhbCA9IHR5cGVvZiB2YWw7XG4gICAgaWYgKCB0eXBlb2Z2YWwgIT09ICdvYmplY3QnICkge1xuICAgICAgICBpZiAoIHR5cGVvZnZhbCA9PT0gJ2Z1bmN0aW9uJyApXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuICEhdmFsO1xuICAgIH1cbiAgICAvLyBsZXQga2V5c0xlbmd0aCA9IE9iamVjdC5rZXlzKHZhbCkubGVuZ3RoO1xuICAgIGxldCB0b1N0cmluZ2VkID0ge30udG9TdHJpbmcuY2FsbCh2YWwpO1xuICAgIGlmICggdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfHwgdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgQXJyYXldJyApXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh2YWwpLmxlbmd0aCAhPT0gMDtcbiAgICBcbiAgICAvLyBCb29sZWFuLCBOdW1iZXIsIEhUTUxFbGVtZW50Li4uXG4gICAgcmV0dXJuICEhdmFsLnZhbHVlT2YoKTtcbn1cblxuZnVuY3Rpb24gZW51bWVyYXRlPFQ+KG9iajogVCk6IEVudW1lcmF0ZWQ8VD4ge1xuICAgIC8vIHVuZGVmaW5lZCAgICBbXVxuICAgIC8vIHt9ICAgICAgICAgICBbXVxuICAgIC8vIFtdICAgICAgICAgICBbXVxuICAgIC8vIFwiXCIgICAgICAgICAgIFtdXG4gICAgLy8gbnVtYmVyICAgICAgIFR5cGVFcnJvclxuICAgIC8vIG51bGwgICAgICAgICBUeXBlRXJyb3JcbiAgICAvLyBib29sZWFuICAgICAgVHlwZUVycm9yXG4gICAgLy8gRnVuY3Rpb24gICAgIFR5cGVFcnJvclxuICAgIC8vIFwiZm9vXCIgICAgICAgIFsgWzAsIFwiZlwiXSwgWzEsIFwib1wiXSwgWzIsIFwib1wiXSBdXG4gICAgLy8gWyBcImZvb1wiIF0gICAgWyBbMCwgXCJmb29cIl0gXVxuICAgIC8vIFsgMTAgXSAgICAgICBbIFswLCAxMF0gXVxuICAgIC8vIHsgYTogXCJmb29cIiB9IFsgW1wiYVwiLCBcImZvb1wiXSBdXG4gICAgLy8gLy8gKCk9Pnt9ICAgID9cbiAgICBsZXQgdHlwZW9mT2JqID0gdHlwZW9mIG9iajtcbiAgICBpZiAoXG4gICAgICAgIG9iaiA9PT0gdW5kZWZpbmVkXG4gICAgICAgIHx8IGlzRW1wdHlPYmoob2JqKVxuICAgICAgICB8fCBpc0VtcHR5QXJyKG9iailcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB8fCBvYmogPT09IFwiXCJcbiAgICApIHtcbiAgICAgICAgcmV0dXJuIFtdIGFzIEVudW1lcmF0ZWQ8VD47XG4gICAgfVxuICAgIFxuICAgIGlmIChcbiAgICAgICAgb2JqID09PSBudWxsXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJib29sZWFuXCJcbiAgICAgICAgfHwgdHlwZW9mT2JqID09PSBcIm51bWJlclwiXG4gICAgICAgIHx8IHR5cGVvZk9iaiA9PT0gXCJmdW5jdGlvblwiXG4gICAgKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dHlwZW9mT2JqfSBvYmplY3QgaXMgbm90IGl0ZXJhYmxlYCk7XG4gICAgfVxuICAgIGxldCBhcnJheSA9IFtdO1xuICAgIGlmICggaXNBcnJheShvYmopICkge1xuICAgICAgICBsZXQgaTogbnVtYmVyID0gMDtcbiAgICAgICAgZm9yICggbGV0IHggb2Ygb2JqICkge1xuICAgICAgICAgICAgYXJyYXkucHVzaChbIGksIHggXSk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKCBsZXQgcHJvcCBpbiBvYmogKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKFsgcHJvcCwgb2JqW3Byb3BdIF0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheSBhcyBFbnVtZXJhdGVkPFQ+O1xufVxuXG5mdW5jdGlvbiB3YWl0KG1zOiBudW1iZXIsIGFja25vd2xlZGdlU2tpcEZhZGUgPSB0cnVlKTogUHJvbWlzZTxhbnk+IHtcbiAgICBpZiAoIGFja25vd2xlZGdlU2tpcEZhZGUgKSB7XG4gICAgICAgIFxuICAgICAgICBpZiAoIHJlcXVpcmUoJy4vR2xvYicpLmRlZmF1bHQuc2tpcEZhZGUgKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYHNraXBGYWRlIWApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmICggR2xvYi5za2lwRmFkZSApIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCAhYm9vbChtcykgKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgdXRpbC53YWl0KCR7bXN9KWApXG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcbn1cblxuLyoqQ2hlY2sgZXZlcnkgYGNoZWNrSW50ZXJ2YWxgIG1zIGlmIGBjb25kKClgIGlzIHRydXRoeS4gSWYsIHdpdGhpbiBgdGltZW91dGAsIGNvbmQoKSBpcyB0cnV0aHksIHJldHVybiBgdHJ1ZWAuIFJldHVybiBgZmFsc2VgIGlmIHRpbWUgaXMgb3V0LlxuICogQGV4YW1wbGVcbiAqIC8vIEdpdmUgdGhlIHVzZXIgYSAyMDBtcyBjaGFuY2UgdG8gZ2V0IGhlciBwb2ludGVyIG92ZXIgXCJteWRpdlwiLiBDb250aW51ZSBpbW1lZGlhdGVseSBvbmNlIHNoZSBkb2VzLCBvciBhZnRlciAyMDBtcyBpZiBzaGUgZG9lc24ndC5cbiAqIG15ZGl2LnBvaW50ZXJlbnRlciggKCkgPT4gbXlkaXYucG9pbnRlckhvdmVyaW5nID0gdHJ1ZTsgKVxuICogY29uc3QgcG9pbnRlck9uTXlkaXYgPSBhd2FpdCB3YWl0VW50aWwoKCkgPT4gbXlkaXYucG9pbnRlckhvdmVyaW5nLCAyMDAsIDEwKTsqL1xuYXN5bmMgZnVuY3Rpb24gd2FpdFVudGlsKGNvbmQ6IEZ1bmN0aW9uUmV0dXJuczxib29sZWFuPiwgY2hlY2tJbnRlcnZhbDogbnVtYmVyID0gMjAsIHRpbWVvdXQ6IG51bWJlciA9IEluZmluaXR5KTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCBjaGVja0ludGVydmFsIDw9IDAgKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGNoZWNrSW50ZXJ2YWwgPD0gMC4gY2hlY2tJbnRlcnZhbDogJHtjaGVja0ludGVydmFsfWApO1xuICAgIGlmICggY2hlY2tJbnRlcnZhbCA+IHRpbWVvdXQgKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGNoZWNrSW50ZXJ2YWwgPiB0aW1lb3V0ICgke2NoZWNrSW50ZXJ2YWx9ID4gJHt0aW1lb3V0fSkuIEhhcyB0byBiZSBsb3dlciB0aGFuIHRpbWVvdXQuYCk7XG4gICAgXG4gICAgY29uc3QgbG9vcHMgPSB0aW1lb3V0IC8gY2hlY2tJbnRlcnZhbDtcbiAgICBpZiAoIGxvb3BzID09IDEgKVxuICAgICAgICBjb25zb2xlLndhcm4oYGxvb3BzID09IDEsIHlvdSBwcm9iYWJseSBkaWRuJ3Qgd2FudCB0aGlzIHRvIGhhcHBlbmApO1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgd2hpbGUgKCBjb3VudCA8IGxvb3BzICkge1xuICAgICAgICBpZiAoIGNvbmQoKSApIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHdhaXQoY2hlY2tJbnRlcnZhbCwgZmFsc2UpO1xuICAgICAgICBjb3VudCsrO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmxldCBzdHVmZiA9IHtcbiAgICAnKCk9Pnt9JyA6ICgpID0+IHtcbiAgICB9LCAnZnVuY3Rpb24oKXt9JyA6IGZ1bmN0aW9uICgpIHtcbiAgICB9LCAnRnVuY3Rpb24nIDogRnVuY3Rpb24sXG4gICAgJ0Z1bmN0aW9uKCknIDogRnVuY3Rpb24oKSxcbiAgICBcIm5ldyBGdW5jdGlvblwiIDogbmV3IEZ1bmN0aW9uLFxuICAgIFwibmV3IEZ1bmN0aW9uKClcIiA6IG5ldyBGdW5jdGlvbigpLFxuICAgIFwiQm9vbGVhblwiIDogQm9vbGVhbixcbiAgICBcIkJvb2xlYW4oKVwiIDogQm9vbGVhbigpLFxuICAgIFwiQm9vbGVhbihmYWxzZSlcIiA6IEJvb2xlYW4oZmFsc2UpLFxuICAgIFwiQm9vbGVhbih0cnVlKVwiIDogQm9vbGVhbih0cnVlKSxcbiAgICBcIm5ldyBCb29sZWFuXCIgOiBuZXcgQm9vbGVhbixcbiAgICBcIm5ldyBCb29sZWFuKClcIiA6IG5ldyBCb29sZWFuKCksXG4gICAgXCJuZXcgQm9vbGVhbih0cnVlKVwiIDogbmV3IEJvb2xlYW4odHJ1ZSksXG4gICAgXCJuZXcgQm9vbGVhbihmYWxzZSlcIiA6IG5ldyBCb29sZWFuKGZhbHNlKSxcbiAgICBcInRydWVcIiA6IHRydWUsXG4gICAgXCJmYWxzZVwiIDogZmFsc2UsXG4gICAgXCJOdW1iZXJcIiA6IE51bWJlcixcbiAgICBcIk51bWJlcigpXCIgOiBOdW1iZXIoKSxcbiAgICBcIk51bWJlcigwKVwiIDogTnVtYmVyKDApLFxuICAgIFwiTnVtYmVyKDEpXCIgOiBOdW1iZXIoMSksXG4gICAgXCJuZXcgTnVtYmVyXCIgOiBuZXcgTnVtYmVyLFxuICAgIFwibmV3IE51bWJlcigpXCIgOiBuZXcgTnVtYmVyKCksXG4gICAgXCJuZXcgTnVtYmVyKDApXCIgOiBuZXcgTnVtYmVyKDApLFxuICAgIFwibmV3IE51bWJlcigxKVwiIDogbmV3IE51bWJlcigxKSxcbiAgICBcIjBcIiA6IDAsXG4gICAgXCIxXCIgOiAxLFxuICAgIFwiJydcIiA6ICcnLFxuICAgIFwiJyAnXCIgOiAnICcsXG4gICAgXCInZm9vJ1wiIDogJ2ZvbycsXG4gICAgXCInMCdcIiA6ICcwJyxcbiAgICBcIicxJ1wiIDogJzEnLFxuICAgIFwie31cIiA6IHt9LFxuICAgIFwieyBoaSA6ICdieWUnIH1cIiA6IHsgaGkgOiAnYnllJyB9LFxuICAgIFwiW11cIiA6IFtdLFxuICAgIFwiWyBmYWxzZSBdXCIgOiBbIGZhbHNlIF0sXG4gICAgXCJbIHRydWUgXVwiIDogWyB0cnVlIF0sXG4gICAgXCJbIFtdIF1cIiA6IFsgW10gXSxcbiAgICBcIlsgMCBdXCIgOiBbIDAgXSxcbiAgICBcIlsgMSBdXCIgOiBbIDEgXSxcbiAgICBcInVuZGVmaW5lZFwiIDogdW5kZWZpbmVkLFxuICAgIFwibnVsbFwiIDogbnVsbCxcbiAgICBcImRvY3VtZW50LmJvZHlcIiA6IGRvY3VtZW50LmJvZHksXG4gICAgXCJuZXcgY2xhc3N7fVwiIDogbmV3IGNsYXNzIHtcbiAgICB9LFxuICAgIFwibmV3IFRpbWVsaW5lKC4uLilcIiA6IFwiUExBQ0VIT0xERVJcIixcbn07XG5cblxuZnVuY3Rpb24gbm90bm90KG9iaikge1xuICAgIC8vIC8gMCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgdHJ1ZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICB0cnVlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgIHRydWVcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oKSAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSAgdHJ1ZVxuICAgIC8vIG5ldyBCb29sZWFuKGZhbHNlKSB0cnVlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvICBmYWxzZSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gIE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICB0cnVlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgIHRydWVcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgdHJ1ZVxuICAgIC8vIC8gJycgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgIHRydWVcbiAgICAvLyBbXSAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyAgdW5kZWZpbmVkICAgICAgIGZhbHNlXG4gICAgLy8gLyAgbnVsbCAgICAgICAgICAgIGZhbHNlXG4gICAgcmV0dXJuICEhb2JqO1xufVxuXG5mdW5jdGlvbiBpc0FycmF5PFQ+KG9iaik6IG9iaiBpcyBBcnJheTxUPiB7IC8vIHNhbWUgYXMgQXJyYXkuaXNBcnJheVxuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnZm9vJyAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcxJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAoKT0+e30gICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbiAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbiAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24oKSAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlciAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbIDEgXSAgICAgICAgICAgICB0cnVlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIHt9ICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBpZiAoICFvYmogKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIHR5cGVvZiBvYmogIT09ICdzdHJpbmcnICYmIChBcnJheS5pc0FycmF5KG9iaikgfHwgdHlwZW9mIG9ialtTeW1ib2wuaXRlcmF0b3JdID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eShvYmo6IGFueSk6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBbXSAgICAgICAgICAgICAgICB0cnVlXG4gICAgLy8gZmFsc2UgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZ1bmN0aW9uKCl7fSAgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyBuZXcgRnVuY3Rpb24oKSAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigwKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKCkgICAgICAgIGZhbHNlXG4gICAgLy8gbnVsbCAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHRydWUgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB1bmRlZmluZWQgICAgICAgICAgIGZhbHNlXG4gICAgLy8geyBoaSA6ICdieWUnIH0gICAgICBmYWxzZVxuICAgIC8vIC8ge30gICAgICAgICAgICAgICAgdHJ1ZVxuICAgIGxldCB0b1N0cmluZ2VkID0ge30udG9TdHJpbmcuY2FsbChvYmopO1xuICAgIHJldHVybiAodG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfHwgdG9TdHJpbmdlZCA9PT0gJ1tvYmplY3QgQXJyYXldJykgJiYgT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT0gMDtcbn1cblxuZnVuY3Rpb24gaXNFbXB0eUFycihjb2xsZWN0aW9uKTogYm9vbGVhbiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbihmYWxzZSkgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4odHJ1ZSkgICBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigxKSAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoKSAgICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyB7IGhpIDogJ2J5ZScgfSAgICAgIGZhbHNlXG4gICAgLy8ge30gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHJldHVybiBpc0FycmF5KGNvbGxlY3Rpb24pICYmIGdldExlbmd0aChjb2xsZWN0aW9uKSA9PT0gMFxufVxuXG5mdW5jdGlvbiBpc0VtcHR5T2JqKG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBbIDEgXSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIGZhbHNlICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmdW5jdGlvbigpe30gICAgICAgIGZhbHNlXG4gICAgLy8gLyBuZXcgQm9vbGVhbigpICAgICB0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbihmYWxzZSl0cnVlXG4gICAgLy8gLyBuZXcgQm9vbGVhbih0cnVlKSB0cnVlXG4gICAgLy8gbmV3IEZ1bmN0aW9uKCkgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IE51bWJlcigwKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigxKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IE51bWJlcigpICAgICAgdHJ1ZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gaXNPYmplY3Qob2JqKSAmJiAhaXNBcnJheShvYmopICYmIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwXG59XG5cblxuZnVuY3Rpb24gaXNGdW5jdGlvbjxUPihmbjogRnVuY3Rpb25SZXR1cm5zPFQ+KTogZm4gaXMgRnVuY3Rpb25SZXR1cm5zPFQ+XG4vLyBmdW5jdGlvbiBpc0Z1bmN0aW9uKGZuOiBBbnlGdW5jdGlvbik6IGZuIGlzIEFueUZ1bmN0aW9uXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGZuKSB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyAoKT0+e30gICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIEJvb2xlYW4gICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIEJvb2xlYW4oKSAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIEZ1bmN0aW9uICAgICAgICAgICAgdHJ1ZVxuICAgIC8vIC8gRnVuY3Rpb24oKSAgICAgICAgICB0cnVlXG4gICAgLy8gLyBOdW1iZXIgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBOdW1iZXIoKSAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gWyAxIF0gICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFtdICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gLyBmdW5jdGlvbigpe30gICAgICAgIHRydWVcbiAgICAvLyBuZXcgQm9vbGVhbigpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKHRydWUpICAgZmFsc2VcbiAgICAvLyAvIG5ldyBGdW5jdGlvbigpICAgICAgdHJ1ZVxuICAgIC8vIG5ldyBOdW1iZXIoMCkgICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDEpICAgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgICBmYWxzZVxuICAgIC8vIG51bGwgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyB0cnVlICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdW5kZWZpbmVkICAgICAgICAgICBmYWxzZVxuICAgIC8vIHsgaGkgOiAnYnllJyB9ICAgICAgZmFsc2VcbiAgICAvLyB7fSAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgbGV0IHRvU3RyaW5nZWQgPSB7fS50b1N0cmluZy5jYWxsKGZuKTtcbiAgICByZXR1cm4gISFmbiAmJiB0b1N0cmluZ2VkID09PSAnW29iamVjdCBGdW5jdGlvbl0nXG59XG5cbmZ1bmN0aW9uIGlzVE1hcDxUPihvYmo6IFRNYXA8VD4pOiBvYmogaXMgVE1hcDxUPiB7XG4gICAgLy8gMCAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIDEgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnJyAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJyAnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcwJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMScgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gKCk9Pnt9ICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIEJvb2xlYW4gICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuKCkgICAgICAgICAgIGZhbHNlXG4gICAgLy8gRnVuY3Rpb24gICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uKCkgICAgICAgICAgZmFsc2VcbiAgICAvLyBOdW1iZXIgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyKCkgICAgICAgICAgICBmYWxzZVxuICAgIC8vIFsgMSBdICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gW10gICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIG5ldyBCb29sZWFuKCkgICAgIGZhbHNlXG4gICAgLy8gbmV3IEJvb2xlYW4oZmFsc2UpZmFsc2VcbiAgICAvLyBuZXcgQm9vbGVhbih0cnVlKSBmYWxzZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyBuZXcgTnVtYmVyKDApICAgICBmYWxzZVxuICAgIC8vIG5ldyBOdW1iZXIoMSkgICAgIGZhbHNlXG4gICAgLy8gbmV3IE51bWJlcigpICAgICAgZmFsc2VcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4ge30udG9TdHJpbmcuY2FsbChvYmopID09ICdbb2JqZWN0IE9iamVjdF0nXG59XG5cbi8vICogIHVuZGVyc2NvcmUuanNcbmZ1bmN0aW9uIGlzT2JqZWN0KG9iaik6IGJvb2xlYW4ge1xuICAgIC8vIDAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAxICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJycgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICcgJyAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAnMCcgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gJzEnICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vICgpPT57fSAgICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBCb29sZWFuICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gQm9vbGVhbigpICAgICAgICAgICBmYWxzZVxuICAgIC8vIEZ1bmN0aW9uICAgICAgICAgICAgZmFsc2VcbiAgICAvLyBGdW5jdGlvbigpICAgICAgICAgIGZhbHNlXG4gICAgLy8gTnVtYmVyICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIE51bWJlcigpICAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIFsgMSBdICAgICAgICAgICAgIHRydWVcbiAgICAvLyAvIFtdICAgICAgICAgICAgICAgIHRydWVcbiAgICAvLyBmYWxzZSAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gZnVuY3Rpb24oKXt9ICAgICAgICBmYWxzZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oKSAgICAgdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4oZmFsc2UpdHJ1ZVxuICAgIC8vIC8gbmV3IEJvb2xlYW4odHJ1ZSkgdHJ1ZVxuICAgIC8vIG5ldyBGdW5jdGlvbigpICAgICAgZmFsc2VcbiAgICAvLyAvIG5ldyBOdW1iZXIoMCkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoMSkgICAgIHRydWVcbiAgICAvLyAvIG5ldyBOdW1iZXIoKSAgICAgIHRydWVcbiAgICAvLyBudWxsICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgLy8gdHJ1ZSAgICAgICAgICAgICAgICBmYWxzZVxuICAgIC8vIHVuZGVmaW5lZCAgICAgICAgICAgZmFsc2VcbiAgICAvLyAvIHsgaGkgOiAnYnllJyB9ICAgIHRydWVcbiAgICAvLyAvIHt9ICAgICAgICAgICAgICAgIHRydWVcbiAgICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgISFvYmo7XG59XG5cblxuZnVuY3Rpb24gc2hhbGxvd1Byb3BlcnR5PFQ+KGtleTogc3RyaW5nKTogKG9iajogVCkgPT4gVCBleHRlbmRzIG51bGwgPyB1bmRlZmluZWQgOiBUW2tleW9mIFRdIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAvLyA9PSBudWxsIHRydWUgZm9yIHVuZGVmaW5lZFxuICAgICAgICByZXR1cm4gb2JqID09IG51bGwgPyB2b2lkIDAgOiBvYmpba2V5XTtcbiAgICB9O1xufVxuXG5cbmZ1bmN0aW9uIGdldExlbmd0aChjb2xsZWN0aW9uKTogbnVtYmVyIHtcbiAgICByZXR1cm4gc2hhbGxvd1Byb3BlcnR5KCdsZW5ndGgnKShjb2xsZWN0aW9uKVxufVxuXG5cbmZ1bmN0aW9uIGFueSguLi5hcmdzOiBhbnlbXSk6IGJvb2xlYW4ge1xuICAgIGZvciAoIGxldCBhIG9mIGFyZ3MgKSB7XG4gICAgICAgIGlmICggYm9vbChhKSApIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuXG5mdW5jdGlvbiBhbGwoLi4uYXJnczogYW55KTogYm9vbGVhbiB7XG4gICAgZm9yICggbGV0IGEgb2YgYXJncyApIHtcbiAgICAgICAgaWYgKCAhYm9vbChhKSApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuXG5mdW5jdGlvbiBzdW0oYXJyOiBhbnlbXSk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IHN1bSA9IDA7XG4gICAgbGV0IGRpcnR5ID0gZmFsc2U7XG4gICAgZm9yICggbGV0IHYgb2YgYXJyICkge1xuICAgICAgICBsZXQgbnVtYmVyID0gcGFyc2VGbG9hdCh2KTtcbiAgICAgICAgaWYgKCAhaXNOYU4obnVtYmVyKSApIHtcbiAgICAgICAgICAgIGRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIHN1bSArPSBudW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuICAgIHJldHVybiAhZGlydHkgPyB1bmRlZmluZWQgOiBzdW07XG59XG5cbmZ1bmN0aW9uIGdldEN1cnJlbnRXaW5kb3coKSB7XG4gICAgcmV0dXJuIHJlbW90ZS5nZXRDdXJyZW50V2luZG93KCk7XG59XG5cbmZ1bmN0aW9uIHJlbG9hZFBhZ2UoKSB7XG4gICAgaWYgKCByZXF1aXJlKFwiLi9HbG9iXCIpLmRlZmF1bHQuQmlnQ29uZmlnLmRldi5ub19yZWxvYWRfb25fc3VibWl0KCkgKSB7XG4gICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oJ3JlbG9hZFBhZ2UoKSwgbm9fcmVsb2FkX29uX3N1Ym1pdCgpJyk7XG4gICAgfVxuICAgIGdldEN1cnJlbnRXaW5kb3coKS5yZWxvYWQoKTtcbn1cblxuZnVuY3Rpb24qIHJhbmdlKHN0YXJ0OiBudW1iZXIsIHN0b3A6IG51bWJlcik6IEdlbmVyYXRvcjxudW1iZXI+IHtcbiAgICBmb3IgKCBsZXQgaSA9IHN0YXJ0OyBpIDw9IHN0b3A7IGkrKyApXG4gICAgICAgIHlpZWxkIGk7XG4gICAgXG59XG5cblxuZXhwb3J0IHtcbiAgICBhbGwsXG4gICAgYW55LFxuICAgIGJvb2wsXG4gICAgZW51bWVyYXRlLFxuICAgIGlzQXJyYXksXG4gICAgaXNGdW5jdGlvbixcbiAgICBpc09iamVjdCxcbiAgICBnZXRDdXJyZW50V2luZG93LFxuICAgIHJhbmdlLFxuICAgIHJlbG9hZFBhZ2UsXG4gICAgc3RyLFxuICAgIHN1bSxcbiAgICB3YWl0LFxuICAgIHdhaXRVbnRpbFxufVxuXG4iXX0=