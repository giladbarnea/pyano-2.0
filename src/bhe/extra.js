"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const index_1 = require("./index");
const Suggestions = require("suggestions");
class InputAndSubmitFlex extends index_1.Div {
    constructor(options) {
        super({ cls: 'input-and-submit-flex' });
        const { placeholder, suggestions, illegalRegex } = options;
        const illegal = (illegalRegex !== null && illegalRegex !== void 0 ? illegalRegex : /[^(a-z0-9A-Z|_.)]/);
        this._suggestions = suggestions;
        const inputElem = index_1.input({ placeholder })
            .on({
            change: (ev) => {
                this.toggleSubmitButtonOnInput();
            }, input: (ev) => {
                this.toggleSubmitButtonOnInput();
            },
            keydown: (ev) => {
                if (ev.ctrlKey || ev.altKey || ev.key.length > 1) {
                    return;
                }
                if ([' ', ',', '-',].includes(ev.key)) {
                    ev.preventDefault();
                    this.input.value += '_';
                }
                else if (ev.key.match(illegal)) {
                    ev.preventDefault();
                }
            },
        });
        const submit = index_1.button({ cls: 'submit inactive' });
        this.cacheAppend({ input: inputElem, submit });
        new Suggestions(inputElem.e, suggestions, {
            limit: 2,
            minLength: 0,
        });
    }
    toggleSubmitButtonOnInput() {
        const inputOk = !!this.input.value;
        this.submit
            .toggleClass('active', inputOk)
            .toggleClass('inactive', !inputOk);
        if (inputOk) {
            this.input.removeClass('invalid');
        }
    }
}
class InputSection extends index_1.Div {
    constructor(options) {
        super({ cls: 'input-section' });
        const { h3text, placeholder, suggestions, illegalRegex } = options;
        const flex = new InputAndSubmitFlex({
            placeholder,
            suggestions,
            illegalRegex
        });
        const subtitle = index_1.elem({ tag: 'h3', text: h3text });
        this.cacheAppend({ subtitle, flex });
    }
}
exports.InputSection = InputSection;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXh0cmEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJleHRyYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1DQUF1RTtBQUV2RSwyQ0FBMEM7QUFRMUMsTUFBTSxrQkFBbUIsU0FBUSxXQUFHO0lBS2hDLFlBQVksT0FBa0M7UUFDMUMsS0FBSyxDQUFDLEVBQUUsR0FBRyxFQUFHLHVCQUF1QixFQUFFLENBQUMsQ0FBQztRQUN6QyxNQUFNLEVBQUUsV0FBVyxFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsR0FBRyxPQUFPLENBQUM7UUFFM0QsTUFBTSxPQUFPLElBQUcsWUFBWSxhQUFaLFlBQVksY0FBWixZQUFZLEdBQUksbUJBQW1CLENBQUEsQ0FBQztRQUNwRCxJQUFJLENBQUMsWUFBWSxHQUFHLFdBQVcsQ0FBQztRQUNoQyxNQUFNLFNBQVMsR0FBRyxhQUFLLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQzthQUNuQyxFQUFFLENBQUM7WUFDQSxNQUFNLEVBQUcsQ0FBQyxFQUFTLEVBQUUsRUFBRTtnQkFDbkIsSUFBSSxDQUFDLHlCQUF5QixFQUFFLENBQUM7WUFDckMsQ0FBQyxFQUFFLEtBQUssRUFBRyxDQUFDLEVBQWMsRUFBRSxFQUFFO2dCQUMxQixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztZQUNyQyxDQUFDO1lBQ0QsT0FBTyxFQUFHLENBQUMsRUFBaUIsRUFBRSxFQUFFO2dCQUM1QixJQUFLLEVBQUUsQ0FBQyxPQUFPLElBQUksRUFBRSxDQUFDLE1BQU0sSUFBSSxFQUFFLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUc7b0JBQ2hELE9BQU87aUJBQ1Y7Z0JBRUQsSUFBSyxDQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRztvQkFDdkMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUNwQixJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssSUFBSSxHQUFHLENBQUM7aUJBQzNCO3FCQUFNLElBQUssRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUc7b0JBQ2hDLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztpQkFFdkI7WUFFTCxDQUFDO1NBRUosQ0FBQyxDQUFDO1FBQ1AsTUFBTSxNQUFNLEdBQUcsY0FBTSxDQUFDLEVBQUUsR0FBRyxFQUFHLGlCQUFpQixFQUFFLENBQUMsQ0FBQztRQUVuRCxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsS0FBSyxFQUFDLFNBQVMsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQzlDLElBQUksV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsV0FBVyxFQUFFO1lBQ3RDLEtBQUssRUFBRyxDQUFDO1lBQ1QsU0FBUyxFQUFHLENBQUM7U0FDaEIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELHlCQUF5QjtRQUNyQixNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7UUFDbkMsSUFBSSxDQUFDLE1BQU07YUFDTixXQUFXLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQzthQUM5QixXQUFXLENBQUMsVUFBVSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdkMsSUFBSyxPQUFPLEVBQUc7WUFDWCxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQTtTQUNwQztJQUtMLENBQUM7Q0FDSjtBQVNELE1BQWEsWUFBYSxTQUFRLFdBQUc7SUFHakMsWUFBWSxPQUE0QjtRQUNwQyxLQUFLLENBQUMsRUFBRSxHQUFHLEVBQUcsZUFBZSxFQUFFLENBQUMsQ0FBQztRQUNqQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLEdBQUcsT0FBTyxDQUFDO1FBQ25FLE1BQU0sSUFBSSxHQUFHLElBQUksa0JBQWtCLENBQUM7WUFDaEMsV0FBVztZQUNYLFdBQVc7WUFDWCxZQUFZO1NBQ2YsQ0FBQyxDQUFDO1FBQ0gsTUFBTSxRQUFRLEdBQUcsWUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFHLElBQUksRUFBRSxJQUFJLEVBQUcsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUNyRCxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDekMsQ0FBQztDQUNKO0FBZEQsb0NBY0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCdXR0b24sIGJ1dHRvbiwgZGl2LCBEaXYsIGVsZW0sIElucHV0LCBpbnB1dCB9IGZyb20gXCIuL2luZGV4XCI7XG5cbmltcG9ydCAqIGFzIFN1Z2dlc3Rpb25zIGZyb20gJ3N1Z2dlc3Rpb25zJ1xuXG5pbnRlcmZhY2UgSW5wdXRBbmRTdWJtaXRGbGV4T3B0aW9ucyB7XG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZyxcbiAgICBzdWdnZXN0aW9uczogc3RyaW5nW10sXG4gICAgaWxsZWdhbFJlZ2V4PzogUmVnRXhwXG59XG5cbmNsYXNzIElucHV0QW5kU3VibWl0RmxleCBleHRlbmRzIERpdiB7XG4gICAgc3VibWl0OiBCdXR0b247XG4gICAgaW5wdXQ6IElucHV0O1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3N1Z2dlc3Rpb25zOiBzdHJpbmdbXTtcbiAgICBcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBJbnB1dEFuZFN1Ym1pdEZsZXhPcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKHsgY2xzIDogJ2lucHV0LWFuZC1zdWJtaXQtZmxleCcgfSk7XG4gICAgICAgIGNvbnN0IHsgcGxhY2Vob2xkZXIsIHN1Z2dlc3Rpb25zLCBpbGxlZ2FsUmVnZXggfSA9IG9wdGlvbnM7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBpbGxlZ2FsID0gaWxsZWdhbFJlZ2V4ID8/IC9bXihhLXowLTlBLVp8Xy4pXS87XG4gICAgICAgIHRoaXMuX3N1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnM7XG4gICAgICAgIGNvbnN0IGlucHV0RWxlbSA9IGlucHV0KHsgcGxhY2Vob2xkZXIgfSlcbiAgICAgICAgICAgIC5vbih7XG4gICAgICAgICAgICAgICAgY2hhbmdlIDogKGV2OiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVN1Ym1pdEJ1dHRvbk9uSW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9LCBpbnB1dCA6IChldjogSW5wdXRFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVN1Ym1pdEJ1dHRvbk9uSW5wdXQoKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGtleWRvd24gOiAoZXY6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBldi5jdHJsS2V5IHx8IGV2LmFsdEtleSB8fCBldi5rZXkubGVuZ3RoID4gMSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBbICcgJywgJywnLCAnLScsIF0uaW5jbHVkZXMoZXYua2V5KSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0LnZhbHVlICs9ICdfJztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggZXYua2V5Lm1hdGNoKGlsbGVnYWwpICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc3VibWl0ID0gYnV0dG9uKHsgY2xzIDogJ3N1Ym1pdCBpbmFjdGl2ZScgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNhY2hlQXBwZW5kKHsgaW5wdXQ6aW5wdXRFbGVtLCBzdWJtaXQgfSk7XG4gICAgICAgIG5ldyBTdWdnZXN0aW9ucyhpbnB1dEVsZW0uZSwgc3VnZ2VzdGlvbnMsIHtcbiAgICAgICAgICAgIGxpbWl0IDogMixcbiAgICAgICAgICAgIG1pbkxlbmd0aCA6IDAsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICB0b2dnbGVTdWJtaXRCdXR0b25PbklucHV0KCkge1xuICAgICAgICBjb25zdCBpbnB1dE9rID0gISF0aGlzLmlucHV0LnZhbHVlO1xuICAgICAgICB0aGlzLnN1Ym1pdFxuICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKCdhY3RpdmUnLCBpbnB1dE9rKVxuICAgICAgICAgICAgLnRvZ2dsZUNsYXNzKCdpbmFjdGl2ZScsICFpbnB1dE9rKTtcbiAgICAgICAgaWYgKCBpbnB1dE9rICkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dC5yZW1vdmVDbGFzcygnaW52YWxpZCcpXG4gICAgICAgIH1cbiAgICAgICAgLyppZiAoIHRoaXMuX292ZXJ3cml0ZVdhcm4gJiYgaW5wdXRPayApIHtcbiAgICAgICAgIHRoaXMuc3VibWl0LnRvZ2dsZUNsYXNzKCd3YXJuJywgdGhpcy5fc3VnZ2VzdGlvbnMubG93ZXJBbGwoKS5pbmNsdWRlcyh0aGlzLmlucHV0RWxlbS52YWx1ZS5sb3dlcigpKSk7XG4gICAgICAgICB9Ki9cbiAgICAgICAgXG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSW5wdXRTZWN0aW9uT3B0aW9ucyB7XG4gICAgaDN0ZXh0OiBzdHJpbmcsXG4gICAgcGxhY2Vob2xkZXI6IHN0cmluZyxcbiAgICBzdWdnZXN0aW9uczogc3RyaW5nW10sXG4gICAgaWxsZWdhbFJlZ2V4PzogUmVnRXhwXG59XG5cbmV4cG9ydCBjbGFzcyBJbnB1dFNlY3Rpb24gZXh0ZW5kcyBEaXYge1xuICAgIGZsZXg6IElucHV0QW5kU3VibWl0RmxleDtcbiAgICBcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zOiBJbnB1dFNlY3Rpb25PcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKHsgY2xzIDogJ2lucHV0LXNlY3Rpb24nIH0pO1xuICAgICAgICBjb25zdCB7IGgzdGV4dCwgcGxhY2Vob2xkZXIsIHN1Z2dlc3Rpb25zLCBpbGxlZ2FsUmVnZXggfSA9IG9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZsZXggPSBuZXcgSW5wdXRBbmRTdWJtaXRGbGV4KHtcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgc3VnZ2VzdGlvbnMsXG4gICAgICAgICAgICBpbGxlZ2FsUmVnZXhcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHN1YnRpdGxlID0gZWxlbSh7IHRhZyA6ICdoMycsIHRleHQgOiBoM3RleHQgfSk7XG4gICAgICAgIHRoaXMuY2FjaGVBcHBlbmQoeyBzdWJ0aXRsZSwgZmxleCB9KTtcbiAgICB9XG59XG4iXX0=