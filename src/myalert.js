"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
console.log('src/myalert/index.ts');
const sweetalert2_1 = require("sweetalert2");
const bhe_1 = require("./bhe");
const path = require("path");
const util_1 = require("./util");
const Glob_1 = require("./Glob");
const swalTypes = {
    info: 0,
    success: 1,
    question: 2,
    warning: 3,
    error: 4
};
function activeIsToast() {
    if (!sweetalert2_1.default.isVisible()) {
        return false;
    }
    return sweetalert2_1.default.getPopup().classList.contains('swal2-toast');
}
function activeType() {
    if (!sweetalert2_1.default.isVisible()) {
        return undefined;
    }
    const classes = sweetalert2_1.default.getIcons().find(div => div.style.display != 'none').classList.value;
    for (let type of ['success', 'error', 'warning', 'info', 'question']) {
        if (classes.includes(type)) {
            return type;
        }
    }
    console.warn(`myalert.index.ts activeType() couldnt find type. classes: ${classes}`);
}
async function generic(options) {
    let propname;
    let propval;
    function _format_value(_propval) {
        if (typeof _propval === 'string') {
            if (_propval.includes('\n')) {
                _propval = _propval.replaceAll('\n', '<br>');
            }
        }
        else if (util_1.isObject(_propval)) {
            _propval = JSON.stringify(_propval);
        }
        return _propval;
    }
    if (options.text || options.html) {
        if (options.text) {
            propname = 'text';
            propval = options.text;
        }
        else if (options.html) {
            propname = 'html';
            propval = options.html;
        }
        propval = _format_value(propval);
        options[propname] = propval;
    }
    if (options.title) {
        options['title'] = _format_value(options.title);
    }
    options = Object.assign({ animation: false, width: '90vw', position: options.toast ? "bottom" : "center", showConfirmButton: !options.toast, timer: 8000 }, options);
    if (sweetalert2_1.default.isVisible()) {
        const takePrecedence = (!options.toast && activeIsToast()) || (swalTypes[options.type] > swalTypes[activeType()]);
        if (takePrecedence) {
            return sweetalert2_1.default.fire(options);
        }
        const currentQueueStep = sweetalert2_1.default.getQueueStep();
        if (currentQueueStep === null) {
            const timedout = !(await util_1.waitUntil(() => !sweetalert2_1.default.isVisible(), 500, 60000));
            if (timedout) {
                console.warn(`Swal.generic() | time out waiting for existing swal to close`);
                return undefined;
            }
            const results = await sweetalert2_1.default.queue([options]);
            return results[0];
        }
        else {
            sweetalert2_1.default.insertQueueStep(options);
            return;
        }
    }
    const results = await sweetalert2_1.default.queue([options]);
    return results[0];
}
const smallMixin = sweetalert2_1.default.mixin({
    position: "bottom-start",
    showConfirmButton: false,
    timer: 8000,
    toast: true,
});
const withConfirm = {
    cancelButtonText: "No",
    confirmButtonText: "Yes",
    showCancelButton: true,
    showConfirmButton: true,
    timer: null,
};
const blockingOptions = {
    allowEnterKey: false,
    allowEscapeKey: false,
    allowOutsideClick: false,
    showCancelButton: false,
    showCloseButton: false,
    showConfirmButton: false,
    timer: null
};
const threeButtonsOptions = Object.assign(Object.assign({}, blockingOptions), { showConfirmButton: true, showCancelButton: true });
const blockingSwalMixin = sweetalert2_1.default.mixin(blockingOptions);
const small = {
    _question(options) {
        return smallMixin.fire(Object.assign(Object.assign({}, options), { type: 'question' }));
    },
    _info(options) {
        return smallMixin.fire(Object.assign(Object.assign({}, options), { type: 'info' }));
    },
    _success(options) {
        return smallMixin.fire(Object.assign(Object.assign({}, options), { type: 'success' }));
    },
    _error(options) {
        return smallMixin.fire(Object.assign(Object.assign({}, options), { type: 'error' }));
    },
    _warning(options) {
        return smallMixin.fire(Object.assign(Object.assign({}, options), { showConfirmButton: true, type: 'warning' }));
    },
    error(title, text) {
        return smallMixin.fire({
            title,
            text,
            type: "error",
        });
    },
    info(title, text = null, showConfirmBtns = false) {
        let infoOptions = {
            title,
            text,
            type: "info",
        };
        if (showConfirmBtns) {
            infoOptions = Object.assign(Object.assign({}, infoOptions), withConfirm);
        }
        return smallMixin.fire(infoOptions);
    },
    success(title, text = null) {
        return generic({
            title,
            text,
            type: "success",
            toast: true
        });
    },
    warning(title, text = null) {
        let warningOptions = {
            title,
            text,
            showConfirmButton: true,
            timer: null,
            type: "warning"
        };
        return smallMixin.fire(warningOptions);
    },
};
const big = {
    async error(options) {
        var _a;
        if (((_a = options) === null || _a === void 0 ? void 0 : _a.html) instanceof Error) {
            const error = options.html;
            const { what, where, cleanstack } = error.toObj();
            console.warn('Error!', error, { cleanstack });
            options.html = `${what}<p>${where}</p>`;
        }
        const dirname = new Date().human();
        if (LOG || !Glob_1.default.BigConfig.get('dev')) {
            options.onOpen = async () => {
                await util_1.takeScreenshot(dirname);
            };
            options.onAfterClose = async () => {
                await util_1.wait(500);
                await util_1.takeScreenshot(dirname);
            };
            options.html += `<p>Logs and screenshot saved to errors/${path.basename(SESSION_PATH_ABS)}/${dirname}</p>`;
        }
        return blockingSwalMixin.fire(Object.assign({ type: 'error', showConfirmButton: true }, options));
    },
    warning(options) {
        return this.oneButton(Object.assign({ type: 'warning' }, options));
    },
    async confirm(options) {
        const { value } = await this.oneButton(Object.assign({ type: 'question', cancelButtonText: "No", confirmButtonText: "Yes", showCancelButton: true, showConfirmButton: true }, options));
        return !!value;
    },
    blocking(options, moreOptions) {
        if (moreOptions && moreOptions.strings && moreOptions.clickFn) {
            let { strings, clickFn } = moreOptions;
            let paragraphs = strings
                .map(s => bhe_1.paragraph({ cls: 'clickable', text: s }))
                .map(pElem => pElem.click(() => clickFn(pElem)));
            options = Object.assign(Object.assign({}, options), { onBeforeOpen(modalElement) {
                    console.log('modalElement:', modalElement);
                    return bhe_1.elem({ byid: 'swal2-content' })
                        .append(...paragraphs);
                } });
        }
        else {
            options = Object.assign({ showConfirmButton: true, showCancelButton: true }, options);
        }
        if (options.showConfirmButton || options.showCancelButton || options.onOpen) {
            return sweetalert2_1.default.fire(Object.assign(Object.assign({}, blockingOptions), options));
        }
        else {
            return new Promise(resolve => sweetalert2_1.default.fire(Object.assign(Object.assign(Object.assign({}, blockingOptions), options), { onOpen: v => resolve(v) })));
        }
    },
    oneButton(options) {
        return generic(Object.assign(Object.assign(Object.assign({}, blockingOptions), { showConfirmButton: true }), options));
    },
    async twoButtons(options) {
        const { value } = await sweetalert2_1.default.fire(Object.assign({ showCancelButton: true }, options));
        return value ? "confirm" : "second";
    },
    async threeButtons(options) {
        let thirdButtonCss;
        if (options.thirdButtonType === "warning") {
            thirdButtonCss = { backgroundColor: '#FFC66D', color: 'black' };
        }
        console.log({ thirdButtonCss });
        let action;
        const onBeforeOpen = (modal) => {
            let el = bhe_1.elem({
                htmlElement: modal,
                children: { actions: '.swal2-actions' }
            });
            el.actions.append(bhe_1.button({ cls: `swal2-confirm swal2-styled`, html: options.thirdButtonText })
                .css(thirdButtonCss)
                .click(async (ev) => {
                action = "third";
                sweetalert2_1.default.clickConfirm();
            }));
        };
        options = Object.assign(Object.assign({}, options), { onBeforeOpen, showCancelButton: true });
        const { value } = await sweetalert2_1.default.fire(options);
        if (value) {
            if (action === undefined) {
                action = "confirm";
            }
        }
        else {
            action = "cancel";
        }
        return action;
    }
};
exports.default = Object.assign({ small, big }, sweetalert2_1.default);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXlhbGVydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm15YWxlcnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFHQSxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUM7QUFDcEMsNkNBQXdGO0FBQ3hGLCtCQUFtRTtBQUNuRSw2QkFBNkI7QUFDN0IsaUNBQW1FO0FBQ25FLGlDQUEwQjtBQUUxQixNQUFNLFNBQVMsR0FBRztJQUNkLElBQUksRUFBRSxDQUFDO0lBQ1AsT0FBTyxFQUFFLENBQUM7SUFDVixRQUFRLEVBQUUsQ0FBQztJQUNYLE9BQU8sRUFBRSxDQUFDO0lBQ1YsS0FBSyxFQUFFLENBQUM7Q0FDWCxDQUFDO0FBRUYsU0FBUyxhQUFhO0lBQ2xCLElBQUksQ0FBQyxxQkFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFO1FBQ25CLE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0lBRUQsT0FBTyxxQkFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDNUQsQ0FBQztBQUVELFNBQVMsVUFBVTtJQUNmLElBQUksQ0FBQyxxQkFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFO1FBQ25CLE9BQU8sU0FBUyxDQUFBO0tBQ25CO0lBQ0QsTUFBTSxPQUFPLEdBQUcscUJBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDO0lBQ3pGLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLEVBQUU7UUFDbEUsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3hCLE9BQU8sSUFBc0IsQ0FBQTtTQUNoQztLQUNKO0lBQ0QsT0FB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QixNQUFNLEdBQUcsU0FBUyxDQUFDO2FBQ3RCO1NBQ0o7YUFBTTtZQUNILE1BQU0sR0FBRyxRQUFRLENBQUM7U0FDckI7UUFFRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0NBQ0osQ0FBQztBQUVGLGtDQUFpQixLQUFLLEVBQUUsR0FBRyxJQUFLLHFCQUFJLEVBQUciLCJzb3VyY2VzQ29udGVudCI6WyIvKippbXBvcnQgQWxlcnQgZnJvbSAnTXlBbGVydCcgKG9yIGFueSBvdGhlciBuYW1lKSovXG5cblxuY29uc29sZS5sb2coJ3NyYy9teWFsZXJ0L2luZGV4LnRzJyk7XG5pbXBvcnQgU3dhbCwgeyBTd2VldEFsZXJ0T3B0aW9ucywgU3dlZXRBbGVydFJlc3VsdCwgU3dlZXRBbGVydFR5cGUgfSBmcm9tICdzd2VldGFsZXJ0Mic7XG5pbXBvcnQgeyBCZXR0ZXJIVE1MRWxlbWVudCwgYnV0dG9uLCBlbGVtLCBwYXJhZ3JhcGggfSBmcm9tIFwiLi9iaGVcIjtcbmltcG9ydCAqIGFzIHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGlzT2JqZWN0LCB0YWtlU2NyZWVuc2hvdCwgd2FpdCwgd2FpdFVudGlsIH0gZnJvbSBcIi4vdXRpbFwiO1xuaW1wb3J0IEdsb2IgZnJvbSBcIi4vR2xvYlwiO1xuXG5jb25zdCBzd2FsVHlwZXMgPSB7XG4gICAgaW5mbzogMCxcbiAgICBzdWNjZXNzOiAxLFxuICAgIHF1ZXN0aW9uOiAyLFxuICAgIHdhcm5pbmc6IDMsXG4gICAgZXJyb3I6IDRcbn07XG5cbmZ1bmN0aW9uIGFjdGl2ZUlzVG9hc3QoKTogYm9vbGVhbiB7XG4gICAgaWYgKCFTd2FsLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHJldHVybiBTd2FsLmdldFBvcHVwKCkuY2xhc3NMaXN0LmNvbnRhaW5zKCdzd2FsMi10b2FzdCcpXG59XG5cbmZ1bmN0aW9uIGFjdGl2ZVR5cGUoKTogU3dlZXRBbGVydFR5cGUge1xuICAgIGlmICghU3dhbC5pc1Zpc2libGUoKSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkXG4gICAgfVxuICAgIGNvbnN0IGNsYXNzZXMgPSBTd2FsLmdldEljb25zKCkuZmluZChkaXYgPT4gZGl2LnN0eWxlLmRpc3BsYXkgIT0gJ25vbmUnKS5jbGFzc0xpc3QudmFsdWU7XG4gICAgZm9yIChsZXQgdHlwZSBvZiBbJ3N1Y2Nlc3MnLCAnZXJyb3InLCAnd2FybmluZycsICdpbmZvJywgJ3F1ZXN0aW9uJ10pIHtcbiAgICAgICAgaWYgKGNsYXNzZXMuaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlIGFzIFN3ZWV0QWxlcnRUeXBlXG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS53YXJuKGBteWFsZXJ0LmluZGV4LnRzIGFjdGl2ZVR5cGUoKSBjb3VsZG50IGZpbmQgdHlwZS4gY2xhc3NlczogJHtjbGFzc2VzfWApXG59XG5cbi8qKkNvbnZlcnRzIG5ld2xpbmVzIHRvIGh0bWwgPGJyPiwgYWVzdGhldGljIGRlZmF1bHRzICh0aW1lcjpudWxsKSwgYW5kIG1hbmFnZXMgU3dhbCBxdWV1ZS4qL1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJpYyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4ge1xuICAgIGxldCBwcm9wbmFtZTtcbiAgICBsZXQgcHJvcHZhbDtcblxuICAgIGZ1bmN0aW9uIF9mb3JtYXRfdmFsdWUoX3Byb3B2YWwpOiBzdHJpbmcge1xuICAgICAgICBpZiAodHlwZW9mIF9wcm9wdmFsID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgaWYgKF9wcm9wdmFsLmluY2x1ZGVzKCdcXG4nKSkge1xuICAgICAgICAgICAgICAgIF9wcm9wdmFsID0gX3Byb3B2YWwucmVwbGFjZUFsbCgnXFxuJywgJzxicj4nKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KF9wcm9wdmFsKSkge1xuICAgICAgICAgICAgX3Byb3B2YWwgPSBKU09OLnN0cmluZ2lmeShfcHJvcHZhbClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3Byb3B2YWxcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucy50ZXh0IHx8IG9wdGlvbnMuaHRtbCkge1xuICAgICAgICBpZiAob3B0aW9ucy50ZXh0KSB7XG4gICAgICAgICAgICBwcm9wbmFtZSA9ICd0ZXh0JztcbiAgICAgICAgICAgIHByb3B2YWwgPSBvcHRpb25zLnRleHQ7XG4gICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5odG1sKSB7XG4gICAgICAgICAgICBwcm9wbmFtZSA9ICdodG1sJztcbiAgICAgICAgICAgIHByb3B2YWwgPSBvcHRpb25zLmh0bWw7XG4gICAgICAgIH1cbiAgICAgICAgcHJvcHZhbCA9IF9mb3JtYXRfdmFsdWUocHJvcHZhbCk7XG4gICAgICAgIG9wdGlvbnNbcHJvcG5hbWVdID0gcHJvcHZhbDtcbiAgICB9XG4gICAgaWYgKG9wdGlvbnMudGl0bGUpIHtcbiAgICAgICAgb3B0aW9uc1sndGl0bGUnXSA9IF9mb3JtYXRfdmFsdWUob3B0aW9ucy50aXRsZSlcbiAgICB9XG4gICAgb3B0aW9ucyA9IHtcbiAgICAgICAgYW5pbWF0aW9uOiBmYWxzZSxcbiAgICAgICAgd2lkdGg6ICc5MHZ3JyxcbiAgICAgICAgcG9zaXRpb246IG9wdGlvbnMudG9hc3QgPyBcImJvdHRvbVwiIDogXCJjZW50ZXJcIixcbiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246ICFvcHRpb25zLnRvYXN0LFxuICAgICAgICB0aW1lcjogODAwMCxcbiAgICAgICAgLy8gdGltZXI6IG51bGwsXG4gICAgICAgIC4uLm9wdGlvbnNcbiAgICB9O1xuICAgIGlmIChTd2FsLmlzVmlzaWJsZSgpKSB7XG4gICAgICAgIC8vIG5vdC10b2FzdCB0cnVtcHMgdG9hc3QsIHdhcm5pbmcgdHJ1bXBzIHN1Y2Nlc3NcbiAgICAgICAgY29uc3QgdGFrZVByZWNlZGVuY2UgPSAoIW9wdGlvbnMudG9hc3QgJiYgYWN0aXZlSXNUb2FzdCgpKSB8fCAoc3dhbFR5cGVzW29wdGlvbnMudHlwZV0gPiBzd2FsVHlwZXNbYWN0aXZlVHlwZSgpXSk7XG4gICAgICAgIGlmICh0YWtlUHJlY2VkZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIFN3YWwuZmlyZShvcHRpb25zKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGN1cnJlbnRRdWV1ZVN0ZXAgPSBTd2FsLmdldFF1ZXVlU3RlcCgpO1xuICAgICAgICBpZiAoY3VycmVudFF1ZXVlU3RlcCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgLy8gKiBTd2FsIGV4aXN0cywgYnV0IGZpcmVkIHRocm91Z2ggYGZpcmVgIGFuZCBub3QgYHF1ZXVlYFxuICAgICAgICAgICAgY29uc3QgdGltZWRvdXQgPSAhKGF3YWl0IHdhaXRVbnRpbCgoKSA9PiAhU3dhbC5pc1Zpc2libGUoKSwgNTAwLCA2MDAwMCkpO1xuICAgICAgICAgICAgaWYgKHRpbWVkb3V0KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBTd2FsLmdlbmVyaWMoKSB8IHRpbWUgb3V0IHdhaXRpbmcgZm9yIGV4aXN0aW5nIHN3YWwgdG8gY2xvc2VgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgU3dhbC5xdWV1ZShbb3B0aW9uc10pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdHNbMF1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vICogU3dhbCBleGlzdHMsIGFuZCBmaXJlZCB0aHJvdWdoIGBxdWV1ZWBcbiAgICAgICAgICAgIFN3YWwuaW5zZXJ0UXVldWVTdGVwKG9wdGlvbnMpO1xuICAgICAgICAgICAgcmV0dXJuXG5cbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgU3dhbC5xdWV1ZShbb3B0aW9uc10pO1xuICAgIHJldHVybiByZXN1bHRzWzBdXG59XG5cbmNvbnN0IHNtYWxsTWl4aW46IHR5cGVvZiBTd2FsID0gU3dhbC5taXhpbih7XG4gICAgcG9zaXRpb246IFwiYm90dG9tLXN0YXJ0XCIsXG4gICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLFxuICAgIHRpbWVyOiA4MDAwLFxuICAgIHRvYXN0OiB0cnVlLFxuXG59KTtcbmNvbnN0IHdpdGhDb25maXJtOiBTd2VldEFsZXJ0T3B0aW9ucyA9IHtcbiAgICBjYW5jZWxCdXR0b25UZXh0OiBcIk5vXCIsXG4gICAgY29uZmlybUJ1dHRvblRleHQ6IFwiWWVzXCIsXG4gICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSxcbiAgICB0aW1lcjogbnVsbCxcblxufTtcbmNvbnN0IGJsb2NraW5nT3B0aW9uczogU3dlZXRBbGVydE9wdGlvbnMgPSB7XG4gICAgYWxsb3dFbnRlcktleTogZmFsc2UsXG4gICAgYWxsb3dFc2NhcGVLZXk6IGZhbHNlLFxuICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSxcbiAgICBzaG93Q2FuY2VsQnV0dG9uOiBmYWxzZSwgLy8gZGVmYXVsdCBmYWxzZVxuICAgIHNob3dDbG9zZUJ1dHRvbjogZmFsc2UsIC8vIGRlZmF1bHQgZmFsc2VcbiAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsXG4gICAgdGltZXI6IG51bGxcbiAgICAvLyB3aWR0aCA6IFwiOTB2d1wiLFxuXG5cbn07XG5jb25zdCB0aHJlZUJ1dHRvbnNPcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyA9IHtcbiAgICAuLi5ibG9ja2luZ09wdGlvbnMsXG4gICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsXG4gICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbn07XG5jb25zdCBibG9ja2luZ1N3YWxNaXhpbiA9IFN3YWwubWl4aW4oYmxvY2tpbmdPcHRpb25zKTtcbnR5cGUgU21hbGwgPSB7XG4gICAgX2Vycm9yKG9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zKTogUHJvbWlzZTxTd2VldEFsZXJ0UmVzdWx0PixcbiAgICBfaW5mbyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4sXG4gICAgX3F1ZXN0aW9uKG9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zKTogUHJvbWlzZTxTd2VldEFsZXJ0UmVzdWx0PixcbiAgICBfc3VjY2VzcyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4sXG4gICAgX3dhcm5pbmcob3B0aW9uczogU3dlZXRBbGVydE9wdGlvbnMpOiBQcm9taXNlPFN3ZWV0QWxlcnRSZXN1bHQ+LFxuICAgIGVycm9yKHRpdGxlOiBzdHJpbmcsIHRleHQ6IHN0cmluZyk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4sXG4gICAgaW5mbyh0aXRsZTogc3RyaW5nLCB0ZXh0PzogKHN0cmluZyB8IG51bGwpLCBzaG93Q29uZmlybUJ0bnM/OiBib29sZWFuKTogUHJvbWlzZTxTd2VldEFsZXJ0UmVzdWx0PixcbiAgICBzdWNjZXNzKHRpdGxlOiBzdHJpbmcsIHRleHQ/OiAoc3RyaW5nIHwgbnVsbCksIHRpbWVyPzogbnVtYmVyKTogUHJvbWlzZTxTd2VldEFsZXJ0UmVzdWx0PixcbiAgICB3YXJuaW5nKHRpdGxlOiBzdHJpbmcsIHRleHQ/OiAoc3RyaW5nIHwgbnVsbCksIHNob3dDb25maXJtQnRucz86IGJvb2xlYW4pOiBQcm9taXNlPFN3ZWV0QWxlcnRSZXN1bHQ+LFxufVxuXG5jb25zdCBzbWFsbDogU21hbGwgPSB7XG4gICAgX3F1ZXN0aW9uKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHNtYWxsTWl4aW4uZmlyZSh7IC4uLm9wdGlvbnMsIHR5cGU6ICdxdWVzdGlvbicgfSlcbiAgICB9LFxuICAgIF9pbmZvKG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHNtYWxsTWl4aW4uZmlyZSh7IC4uLm9wdGlvbnMsIHR5cGU6ICdpbmZvJyB9KVxuICAgIH0sXG4gICAgX3N1Y2Nlc3Mob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gc21hbGxNaXhpbi5maXJlKHsgLi4ub3B0aW9ucywgdHlwZTogJ3N1Y2Nlc3MnIH0pXG4gICAgfSxcbiAgICBfZXJyb3Iob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gc21hbGxNaXhpbi5maXJlKHsgLi4ub3B0aW9ucywgdHlwZTogJ2Vycm9yJyB9KVxuICAgIH0sXG4gICAgX3dhcm5pbmcob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gc21hbGxNaXhpbi5maXJlKHtcbiAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSwgdHlwZTogJ3dhcm5pbmcnXG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBlcnJvcih0aXRsZSwgdGV4dCkge1xuICAgICAgICByZXR1cm4gc21hbGxNaXhpbi5maXJlKHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIHR5cGU6IFwiZXJyb3JcIixcblxuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGluZm8odGl0bGUsIHRleHQgPSBudWxsLCBzaG93Q29uZmlybUJ0bnMgPSBmYWxzZSkge1xuICAgICAgICBsZXQgaW5mb09wdGlvbnMgPSB7XG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIHRleHQsXG4gICAgICAgICAgICB0eXBlOiBcImluZm9cIixcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHNob3dDb25maXJtQnRucykge1xuICAgICAgICAgICAgaW5mb09wdGlvbnMgPSB7IC4uLmluZm9PcHRpb25zLCAuLi53aXRoQ29uZmlybSB9O1xuICAgICAgICB9XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIHNtYWxsTWl4aW4uZmlyZShpbmZvT3B0aW9ucyk7XG4gICAgfSxcbiAgICBzdWNjZXNzKHRpdGxlLCB0ZXh0ID0gbnVsbCkge1xuXG4gICAgICAgIHJldHVybiBnZW5lcmljKHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIHR5cGU6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgdG9hc3Q6IHRydWVcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIHdhcm5pbmcodGl0bGUsIHRleHQgPSBudWxsKSB7XG4gICAgICAgIGxldCB3YXJuaW5nT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgdGltZXI6IG51bGwsXG4gICAgICAgICAgICB0eXBlOiBcIndhcm5pbmdcIlxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIHNtYWxsTWl4aW4uZmlyZSh3YXJuaW5nT3B0aW9ucyk7XG4gICAgfSxcblxufTtcbmV4cG9ydCB0eXBlIENyZWF0ZUNvbmZpcm1UaGlyZCA9IFwiY29uZmlybVwiIHwgXCJjYW5jZWxcIiB8IFwidGhpcmRcIjtcbnR5cGUgQmlnID0ge1xuXG4gICAgZXJyb3Iob3B0aW9uczogT21pdDxTd2VldEFsZXJ0T3B0aW9ucywgJ29uT3BlbicgfCAnb25BZnRlckNsb3NlJz4gJiB7IGh0bWw6IHN0cmluZyB8IEVycm9yIH0pOiBQcm9taXNlPFN3ZWV0QWxlcnRSZXN1bHQ+LFxuICAgIHdhcm5pbmcob3B0aW9uczogU3dlZXRBbGVydE9wdGlvbnMpOiBQcm9taXNlPFN3ZWV0QWxlcnRSZXN1bHQ+LFxuICAgIGNvbmZpcm0ob3B0aW9uczogU3dlZXRBbGVydE9wdGlvbnMpOiBQcm9taXNlPGJvb2xlYW4+LFxuICAgIGJsb2NraW5nKG9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zLCBtb3JlT3B0aW9ucz86IHsgc3RyaW5nczogc3RyaW5nW10sIGNsaWNrRm46IChiaGU6IEJldHRlckhUTUxFbGVtZW50KSA9PiBhbnkgfSk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4sXG4gICAgb25lQnV0dG9uKG9wdGlvbnM/OiBTd2VldEFsZXJ0T3B0aW9ucyk6IFByb21pc2U8U3dlZXRBbGVydFJlc3VsdD4sXG4gICAgdHdvQnV0dG9ucyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyk6IFByb21pc2U8XCJjb25maXJtXCIgfCBcInNlY29uZFwiPlxuICAgIHRocmVlQnV0dG9ucyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucyAmIHsgdGhpcmRCdXR0b25UZXh0OiBzdHJpbmcsIHRoaXJkQnV0dG9uVHlwZT86IFwiY29uZmlybVwiIHwgXCJ3YXJuaW5nXCIgfSk6IFByb21pc2U8Q3JlYXRlQ29uZmlybVRoaXJkPlxufVxuXG5jb25zdCBiaWc6IEJpZyA9IHtcblxuICAgIGFzeW5jIGVycm9yKG9wdGlvbnMpIHtcblxuICAgICAgICBpZiAob3B0aW9ucz8uaHRtbCBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG9wdGlvbnMuaHRtbDtcblxuXG4gICAgICAgICAgICBjb25zdCB7IHdoYXQsIHdoZXJlLCBjbGVhbnN0YWNrIH0gPSBlcnJvci50b09iaigpO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdFcnJvciEnLCBlcnJvciwgeyBjbGVhbnN0YWNrIH0pO1xuICAgICAgICAgICAgb3B0aW9ucy5odG1sID0gYCR7d2hhdH08cD4ke3doZXJlfTwvcD5gXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGlybmFtZSA9IG5ldyBEYXRlKCkuaHVtYW4oKTtcbiAgICAgICAgLy8gY29uc3QgeyBkZWZhdWx0OiBHbG9iIH0gPSByZXF1aXJlKCcuLi9HbG9iJyk7XG4gICAgICAgIGlmIChMT0cgfHwgIUdsb2IuQmlnQ29uZmlnLmdldCgnZGV2JykpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIG9wdGlvbnMub25PcGVuID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRha2VTY3JlZW5zaG90KGRpcm5hbWUpO1xuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgb3B0aW9ucy5vbkFmdGVyQ2xvc2UgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgd2FpdCg1MDApO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRha2VTY3JlZW5zaG90KGRpcm5hbWUpO1xuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgb3B0aW9ucy5odG1sICs9IGA8cD5Mb2dzIGFuZCBzY3JlZW5zaG90IHNhdmVkIHRvIGVycm9ycy8ke3BhdGguYmFzZW5hbWUoU0VTU0lPTl9QQVRIX0FCUyl9LyR7ZGlybmFtZX08L3A+YFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJsb2NraW5nU3dhbE1peGluLmZpcmUoe1xuICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICB9KTtcbiAgICB9LFxuICAgIHdhcm5pbmcob3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5vbmVCdXR0b24oeyB0eXBlOiAnd2FybmluZycsIC4uLm9wdGlvbnMgfSk7XG4gICAgfSxcbiAgICBhc3luYyBjb25maXJtKG9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gYXdhaXQgdGhpcy5vbmVCdXR0b24oe1xuICAgICAgICAgICAgdHlwZTogJ3F1ZXN0aW9uJyxcbiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IFwiTm9cIixcbiAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllc1wiLFxuICAgICAgICAgICAgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICEhdmFsdWU7XG4gICAgfSxcblxuICAgIGJsb2NraW5nKG9wdGlvbnMsIG1vcmVPcHRpb25zKSB7XG5cbiAgICAgICAgaWYgKG1vcmVPcHRpb25zICYmIG1vcmVPcHRpb25zLnN0cmluZ3MgJiYgbW9yZU9wdGlvbnMuY2xpY2tGbikge1xuICAgICAgICAgICAgbGV0IHsgc3RyaW5ncywgY2xpY2tGbiB9ID0gbW9yZU9wdGlvbnM7XG5cbiAgICAgICAgICAgIGxldCBwYXJhZ3JhcGhzID0gc3RyaW5nc1xuICAgICAgICAgICAgICAgIC8vIC5tYXAocyA9PiAkKGA8cCBjbGFzcz1cImNsaWNrYWJsZVwiPiR7c308L3A+YCkpXG4gICAgICAgICAgICAgICAgLm1hcChzID0+IHBhcmFncmFwaCh7IGNsczogJ2NsaWNrYWJsZScsIHRleHQ6IHMgfSkpXG4gICAgICAgICAgICAgICAgLm1hcChwRWxlbSA9PiBwRWxlbS5jbGljaygoKSA9PiBjbGlja0ZuKHBFbGVtKSkpO1xuXG4gICAgICAgICAgICBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICAgICAgb25CZWZvcmVPcGVuKG1vZGFsRWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ21vZGFsRWxlbWVudDonLCBtb2RhbEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbSh7IGJ5aWQ6ICdzd2FsMi1jb250ZW50JyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLnNob3coKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCguLi5wYXJhZ3JhcGhzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2UgeyAvLyBmb3JjZSBjb25maXJtIGFuZCBjYW5jZWwgYnV0dG9uc1xuICAgICAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLnNob3dDb25maXJtQnV0dG9uIHx8IG9wdGlvbnMuc2hvd0NhbmNlbEJ1dHRvbiB8fCBvcHRpb25zLm9uT3Blbikge1xuICAgICAgICAgICAgLy8gLyBIYXBwZW5zIHdoZW4gbm90IG9yIGJhZCBtb3JlT3B0aW9uc1xuICAgICAgICAgICAgcmV0dXJuIFN3YWwuZmlyZSh7IC4uLmJsb2NraW5nT3B0aW9ucywgLi4ub3B0aW9ucyB9KTtcbiAgICAgICAgfSBlbHNlIHsgLy8gVE9ETzogb25PcGVuIDogcmVzb2x2ZT9cblxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gU3dhbC5maXJlKHsgLi4uYmxvY2tpbmdPcHRpb25zLCAuLi5vcHRpb25zLCBvbk9wZW46IHYgPT4gcmVzb2x2ZSh2KSB9KSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIG9uZUJ1dHRvbihvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucykge1xuICAgICAgICAvKmNvbnNvbGUubG9nKHsgdGl0bGUsIG9wdGlvbnMgfSk7XG4gICAgICAgICBjb25zdCB0eXBlb2Z0aXRsZSA9IHR5cGVvZiB0aXRsZTtcbiAgICAgICAgIGlmICggdHlwZW9mdGl0bGUgPT09IFwib2JqZWN0XCIgKSB7XG4gICAgICAgICBpZiAoIG9wdGlvbnMgKSB7XG4gICAgICAgICBpZiAoIG9wdGlvbnMuaHRtbCApIHtcbiAgICAgICAgIG9wdGlvbnMuaHRtbCArPSAnPGJyPic7XG4gICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgb3B0aW9ucy5odG1sID0gJyc7XG4gICAgICAgICB9XG4gICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgb3B0aW9ucyA9IHsgaHRtbCA6ICcnIH07XG4gICAgICAgICB9XG4gICAgICAgICBpZiAoIHRpdGxlIGluc3RhbmNlb2YgRXJyb3IgKSB7XG4gICAgICAgICB0aXRsZSA9ICdBbiBlcnJvciBoYXMgb2NjdXJyZWQnO1xuICAgICAgICAgb3B0aW9ucy5odG1sICs9IHRpdGxlLm1lc3NhZ2U7XG4gICAgICAgICBjb25zb2xlLmxvZyh7IHRpdGxlLCBvcHRpb25zIH0pO1xuICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgIGxldCBodG1sID0gYDxzdHlsZT5cbiAgICAgICAgIHNwYW4ge1xuICAgICAgICAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbiAgICAgICAgIG1hcmdpbi1sZWZ0OiA0MHB4O1xuICAgICAgICAgfVxuICAgICAgICAgPC9zdHlsZT5cbiAgICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBsZWZ0XCI+XG5cbiAgICAgICAgIGA7XG4gICAgICAgICBmb3IgKCBsZXQga2V5IG9mIE9iamVjdC5rZXlzKHRpdGxlKSApIHtcbiAgICAgICAgIGh0bWwgKz0gYDxwPjxiPiR7a2V5fTo8L2I+IDxzcGFuPiR7dGl0bGVba2V5XX08L3NwYW4+PC9wPmBcbiAgICAgICAgIH1cbiAgICAgICAgIGh0bWwgKz0gYDwvZGl2PmA7XG4gICAgICAgICBvcHRpb25zLmh0bWwgKz0gaHRtbDtcbiAgICAgICAgIHRpdGxlID0gJ1NvbWV0aGluZyBoYXBwZW5lZCc7XG5cbiAgICAgICAgIH1cbiAgICAgICAgIH0gZWxzZSBpZiAoIEFycmF5LmlzQXJyYXkodGl0bGUpICkge1xuICAgICAgICAgdGl0bGUgPSAnVGhpcyBpcyB3ZWlyZCc7XG4gICAgICAgICBvcHRpb25zLmh0bWwgKz0gdGl0bGUuam9pbignPC9icj4nKVxuICAgICAgICAgfSovXG4gICAgICAgIHJldHVybiBnZW5lcmljKHtcbiAgICAgICAgICAgIC4uLmJsb2NraW5nT3B0aW9ucyxcbiAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgLi4ub3B0aW9ucyxcblxuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHR3b0J1dHRvbnMob3B0aW9ucykge1xuXG4gICAgICAgIGNvbnN0IHsgdmFsdWUgfSA9IGF3YWl0IFN3YWwuZmlyZSh7XG4gICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLFxuICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gdmFsdWUgPyBcImNvbmZpcm1cIiA6IFwic2Vjb25kXCI7XG4gICAgfSxcbiAgICBhc3luYyB0aHJlZUJ1dHRvbnMob3B0aW9ucykge1xuXG4gICAgICAgIC8vIGNvbnN0IHRoaXJkQnV0dG9uVGV4dCA9IG9wdGlvbnMudGhpcmRCdXR0b25UZXh0ID8/ICdPdmVyd3JpdGUnO1xuICAgICAgICBsZXQgdGhpcmRCdXR0b25Dc3M7XG4gICAgICAgIGlmIChvcHRpb25zLnRoaXJkQnV0dG9uVHlwZSA9PT0gXCJ3YXJuaW5nXCIpIHtcbiAgICAgICAgICAgIHRoaXJkQnV0dG9uQ3NzID0geyBiYWNrZ3JvdW5kQ29sb3I6ICcjRkZDNjZEJywgY29sb3I6ICdibGFjaycgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coeyB0aGlyZEJ1dHRvbkNzcyB9KTtcbiAgICAgICAgbGV0IGFjdGlvbjogQ3JlYXRlQ29uZmlybVRoaXJkO1xuICAgICAgICBjb25zdCBvbkJlZm9yZU9wZW4gPSAobW9kYWw6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBsZXQgZWwgPSBlbGVtKHtcbiAgICAgICAgICAgICAgICBodG1sRWxlbWVudDogbW9kYWwsXG4gICAgICAgICAgICAgICAgY2hpbGRyZW46IHsgYWN0aW9uczogJy5zd2FsMi1hY3Rpb25zJyB9XG4gICAgICAgICAgICB9KSBhcyBCZXR0ZXJIVE1MRWxlbWVudCAmIHsgYWN0aW9uczogQmV0dGVySFRNTEVsZW1lbnQgfTtcblxuICAgICAgICAgICAgZWwuYWN0aW9ucy5hcHBlbmQoXG4gICAgICAgICAgICAgICAgYnV0dG9uKHsgY2xzOiBgc3dhbDItY29uZmlybSBzd2FsMi1zdHlsZWRgLCBodG1sOiBvcHRpb25zLnRoaXJkQnV0dG9uVGV4dCB9KVxuXG4gICAgICAgICAgICAgICAgICAgIC5jc3ModGhpcmRCdXR0b25Dc3MpXG4gICAgICAgICAgICAgICAgICAgIC5jbGljayhhc3luYyAoZXY6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IFwidGhpcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIFN3YWwuY2xpY2tDb25maXJtKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG4gICAgICAgIH07XG4gICAgICAgIG9wdGlvbnMgPSB7IC4uLm9wdGlvbnMsIG9uQmVmb3JlT3Blbiwgc2hvd0NhbmNlbEJ1dHRvbjogdHJ1ZSB9O1xuICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSBhd2FpdCBTd2FsLmZpcmUob3B0aW9ucyk7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgLy8vIEVpdGhlciB1c2VyIGNsaWNrZWQgQ29uZmlybSAoYWN0aW9uIGlzIHVuZGVmaW5lZCkgb3IgU3dhbC5jbGlja0NvbmZpcm0oKSAoYWN0aW9uIGlzIFwidGhpcmRcIilcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGFjdGlvbiA9IFwiY29uZmlybVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWN0aW9uID0gXCJjYW5jZWxcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhY3Rpb247XG4gICAgfVxufTtcbi8vIGV4cG9ydCBkZWZhdWx0IHsgYWxlcnRGbiwgc21hbGwsIGJpZywgY2xvc2UgOiBTd2FsLmNsb3NlLCBpc1Zpc2libGUgOiBTd2FsLmlzVmlzaWJsZSB9O1xuZXhwb3J0IGRlZmF1bHQgeyBzbWFsbCwgYmlnLCAuLi5Td2FsIH07XG4iXX0=