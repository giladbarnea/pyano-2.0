const { remote } = require('electron');
const argvars = remote.process.argv.slice(2).map(s => s.toLowerCase());
const DEBUG = argvars.includes('debug');
const DRYRUN = argvars.includes('dry-run');
const path = require('path');
const fs = require('fs');
const ROOT_PATH_ABS = path.basename(__dirname) === 'src' ? path.join(__dirname, '..') : __dirname;
const { PythonShell } = require("python-shell");
const enginePath = path.join(ROOT_PATH_ABS, "src", "engine");
const pyExecPath = path.join(enginePath, process.platform === "linux" ? "env/bin/python" : "env/Scripts/python.exe");
console.group(`renderer.ts`);
console.table({ __dirname, ROOT_PATH_ABS, DEBUG, DRYRUN, enginePath, pyExecPath });
PythonShell.defaultOptions = {
    pythonPath: pyExecPath,
    pythonOptions: ['-OO'],
};
PythonShell.prototype.runAsync = function () {
    return new Promise((resolve, reject) => {
        const messages = [];
        this.on('message', message => messages.push(message));
        this.end((err, code, signal) => {
            if (err)
                reject(err);
            resolve(messages);
        });
    });
};
PythonShell.myrun = function (scriptPath, options = { args: [], pythonOptions: ['-OO'] }, callback) {
    if (scriptPath.startsWith('-m')) {
        scriptPath = scriptPath.slice(3);
        if (!options.pythonOptions) {
            options.pythonOptions = ['-m'];
        }
        else {
            if (!options.pythonOptions.includes('-m')) {
                options.pythonOptions.push('-m');
            }
        }
    }
    options.args = [ROOT_PATH_ABS, ...options.args];
    if (DEBUG)
        options.args.push('debug');
    if (DRYRUN)
        options.args.push('dry-run');
    if (!callback) {
        callback = (err, output) => {
            if (err) {
                console.error(err);
            }
            if (output)
                console.log(`%c${scriptPath}\n`, 'font-weight: bold', output.join('\n'));
        };
    }
    return PythonShell.run(scriptPath, options, callback);
};
PythonShell.myrun("-m checks.dirs");
const Store = new (require("electron-store"))();
console.log(`Store.path: `, Store.path);
PythonShell.myrun("-m checks.config", { args: [Store.path] });
let skipFade = false;
module.exports = {
    skipFade,
    PythonShell
};
console.groupEnd();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZW5kZXJlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFRQSxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3ZDLE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztBQUN2RSxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3hDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7QUFFM0MsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzdCLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN6QixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUdsRyxNQUFNLEVBQUUsV0FBVyxFQUFFLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQ2hELE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztBQUM3RCxNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxPQUFPLENBQUMsUUFBUSxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUM7QUFD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QyxDQUFDO0FBQ3hDLFdBQVcsQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUcsQ0FBRSxLQUFLLENBQUMsSUFBSSxDQUFFLEVBQUUsQ0FBQyxDQUFDO0FBR2pFLElBQUksUUFBUSxHQUFHLEtBQUssQ0FBQztBQUVyQixNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2IsUUFBUTtJQUVSLFdBQVc7Q0FDZCxDQUFDO0FBQ0YsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhpcyBmaWxlIGlzIHJlcXVpcmVkIGJ5IHRoZSBpbmRleC5odG1sIGZpbGUgYW5kIHdpbGxcbi8vIGJlIGV4ZWN1dGVkIGluIHRoZSByZW5kZXJlciBwcm9jZXNzIGZvciB0aGF0IHdpbmRvdy5cbi8vIE5vIE5vZGUuanMgQVBJcyBhcmUgYXZhaWxhYmxlIGluIHRoaXMgcHJvY2VzcyBiZWNhdXNlXG4vLyBgbm9kZUludGVncmF0aW9uYCBpcyB0dXJuZWQgb2ZmLiBVc2UgYHByZWxvYWQuanNgIHRvXG4vLyBzZWxlY3RpdmVseSBlbmFibGUgZmVhdHVyZXMgbmVlZGVkIGluIHRoZSByZW5kZXJpbmdcbi8vIHByb2Nlc3MuXG5cblxuY29uc3QgeyByZW1vdGUgfSA9IHJlcXVpcmUoJ2VsZWN0cm9uJyk7XG5jb25zdCBhcmd2YXJzID0gcmVtb3RlLnByb2Nlc3MuYXJndi5zbGljZSgyKS5tYXAocyA9PiBzLnRvTG93ZXJDYXNlKCkpO1xuY29uc3QgREVCVUcgPSBhcmd2YXJzLmluY2x1ZGVzKCdkZWJ1ZycpO1xuY29uc3QgRFJZUlVOID0gYXJndmFycy5pbmNsdWRlcygnZHJ5LXJ1bicpO1xuLy8gQHRzLWlnbm9yZVxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IFJPT1RfUEFUSF9BQlMgPSBwYXRoLmJhc2VuYW1lKF9fZGlybmFtZSkgPT09ICdzcmMnID8gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJykgOiBfX2Rpcm5hbWU7XG5cbi8vICoqICBQeXRob25TaGVsbFxuY29uc3QgeyBQeXRob25TaGVsbCB9ID0gcmVxdWlyZShcInB5dGhvbi1zaGVsbFwiKTtcbmNvbnN0IGVuZ2luZVBhdGggPSBwYXRoLmpvaW4oUk9PVF9QQVRIX0FCUywgXCJzcmNcIiwgXCJlbmdpbmVcIik7XG5jb25zdCBweUV4ZWNQYXRoID0gcGF0aC5qb2luKGVuZ2luZVBhdGgsIHByb2Nlc3MucGxhdGZvcm0gPT09IFwibGludXhcIiA/IFwiZW52L2Jpbi9weXRob25cIiA6IFwiZW52L1NjcmlwdHMvcHl0aG9uLmV4ZVwiKTtcbmNvbnNvbGUuZ3JvdXAoYHJlbmRlcmVyLnRzYCk7XG5jb25zb2xlLnRhYmxlKHsgX19kaXJuYW1lLCBST09UX1BBVEhfQUJTLCBERUJVRywgRFJZUlVOLCBlbmdpbmVQYXRoLCBweUV4ZWNQYXRoIH0pO1xuLypjb25zdCB7IHNwYXduU3luYyB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpO1xuIGNvbnN0IHsgb3V0cHV0IH0gPSBzcGF3blN5bmMoUHl0aG9uU2hlbGwuZ2V0UHl0aG9uUGF0aCgpLCBbICctYyBwcmludChcImhpXCIpJyBdKTtcbiBpZiAoIG91dHB1dCA9PT0gbnVsbCApIHtcbiAvLyBUT0RPOiB0ZXN0XG4gY29uc29sZS5lcnJvcihgU3Bhd25pbmcgYSBQeXRob25TaGVsbC5nZXRQeXRob25QYXRoKCkgZmFpbGVkYCk7XG4gcHJvY2Vzcy5leGl0KDApO1xuIH0qL1xuUHl0aG9uU2hlbGwuZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgcHl0aG9uUGF0aCA6IHB5RXhlY1BhdGgsXG4gICAgLy8gc2NyaXB0UGF0aCA6IGVuZ2luZVBhdGgsXG4gICAgcHl0aG9uT3B0aW9ucyA6IFsgJy1PTycgXSxcbn07XG5cblxuUHl0aG9uU2hlbGwucHJvdG90eXBlLnJ1bkFzeW5jID0gZnVuY3Rpb24gKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtdO1xuICAgICAgICB0aGlzLm9uKCdtZXNzYWdlJywgbWVzc2FnZSA9PiBtZXNzYWdlcy5wdXNoKG1lc3NhZ2UpKTtcbiAgICAgICAgXG4gICAgICAgIFxuICAgICAgICB0aGlzLmVuZCgoZXJyLCBjb2RlLCBzaWduYWwpID0+IHtcbiAgICAgICAgICAgIGlmICggZXJyICkgcmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2VzKVxuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5QeXRob25TaGVsbC5teXJ1biA9IGZ1bmN0aW9uIChzY3JpcHRQYXRoOiBzdHJpbmcsIG9wdGlvbnMgPSB7IGFyZ3MgOiBbXSwgcHl0aG9uT3B0aW9ucyA6IFsgJy1PTycgXSB9LCBjYWxsYmFjaykge1xuICAgIFxuICAgIGlmICggc2NyaXB0UGF0aC5zdGFydHNXaXRoKCctbScpICkge1xuICAgICAgICBzY3JpcHRQYXRoID0gc2NyaXB0UGF0aC5zbGljZSgzKTtcbiAgICAgICAgaWYgKCAhb3B0aW9ucy5weXRob25PcHRpb25zICkge1xuICAgICAgICAgICAgb3B0aW9ucy5weXRob25PcHRpb25zID0gWyAnLW0nIF1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICggIW9wdGlvbnMucHl0aG9uT3B0aW9ucy5pbmNsdWRlcygnLW0nKSApIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zLnB5dGhvbk9wdGlvbnMucHVzaCgnLW0nKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG9wdGlvbnMuYXJncyA9IFsgUk9PVF9QQVRIX0FCUywgLi4ub3B0aW9ucy5hcmdzIF07XG4gICAgaWYgKCBERUJVRyApXG4gICAgICAgIG9wdGlvbnMuYXJncy5wdXNoKCdkZWJ1ZycpO1xuICAgIGlmICggRFJZUlVOIClcbiAgICAgICAgb3B0aW9ucy5hcmdzLnB1c2goJ2RyeS1ydW4nKTtcbiAgICBpZiAoICFjYWxsYmFjayApIHtcbiAgICAgICAgY2FsbGJhY2sgPSAoZXJyLCBvdXRwdXQpID0+IHtcbiAgICAgICAgICAgIGlmICggZXJyICkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggb3V0cHV0IClcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgJWMke3NjcmlwdFBhdGh9XFxuYCwgJ2ZvbnQtd2VpZ2h0OiBib2xkJywgb3V0cHV0LmpvaW4oJ1xcbicpKVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBQeXRob25TaGVsbC5ydW4oc2NyaXB0UGF0aCwgb3B0aW9ucywgY2FsbGJhY2spXG59O1xuXG5cblB5dGhvblNoZWxsLm15cnVuKFwiLW0gY2hlY2tzLmRpcnNcIik7XG4vLyAqKiAgRWxlY3Ryb24gU3RvcmVcbmNvbnN0IFN0b3JlID0gbmV3IChyZXF1aXJlKFwiZWxlY3Ryb24tc3RvcmVcIikpKCk7XG5jb25zb2xlLmxvZyhgU3RvcmUucGF0aDogYCwgU3RvcmUucGF0aCk7XG5QeXRob25TaGVsbC5teXJ1bihcIi1tIGNoZWNrcy5jb25maWdcIiwgeyBhcmdzIDogWyBTdG9yZS5wYXRoIF0gfSk7XG5cblxubGV0IHNraXBGYWRlID0gZmFsc2U7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIHNraXBGYWRlLFxuICAgIC8vIFN0b3JlLFxuICAgIFB5dGhvblNoZWxsXG59O1xuY29uc29sZS5ncm91cEVuZCgpO1xuIl19